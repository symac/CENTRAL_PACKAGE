{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/CENTRAL_PACKAGE/js/main.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmAuthenticationAfter/forceAuth.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmBriefResultAfter/customBriefDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmExploreFooterAfter/logosInsts.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFacetExactAfter/customTLevelFacette.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/dispoElecAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmGalleryItemAfter/customGalleryDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoanAfter/itemInLoan.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoginAfter/authentificationAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchBarAfter/showAlertMessage.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchResultAvailabilityLineAfter/affDispo.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchResultThumbnailContainerAfter/getThumbnail.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmTopbarAfter/message.service.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmTopbarAfter/prmTopbarAfter.component.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_customTLevelFacette","_authentificationAutresInst","_customBriefDisplay","_customGalleryDisplay","_affDispo","_dispoElecAutresInst","_itemInLoan","_forceAuth","_logosInsts","_message","_prmTopbarAfter","app","angular","component","tLevelFacetteConfig","authentificationAutresInstConfig","customBriefDisplayConfig","customGalleryDisplayConfig","affDispoConfig","dispoElecAutresInstConfig","itemInLoanConfig","forceAuthConfig","logosInstsConfig","service","MessageService","PrmTopbarAfterConfig","name","config","bindings","parentCtrl","controller","forceAuthController","_classCallCheck","this","url","key","queryStartPos","indexOf","params","substring","split","pairs","decodeURIComponent","shift","join","getQueryParam","loginService","$location","$$absUrl","target_url","replace","encodeURIComponent","institution","authenticationService","userSessionManagerService","inst","authenticationProfile","auth_url","location","href","customBriefDisplayController","item","context","firstLinetext","otherLines","auteur","pnx","display","creator","editeur","publisher","source","pubDate","creationdate","ispartof","adresse","hSecondLine","values","clazz","codes","text","delimiter","unshift","hFirstLine","control","recordid","startsWith","bibAddr","logosInstsController","_this","URL","document","displayFooter","searchParams","get","pathname","view","myInstitution","institutionsList","institutionsUrl","mappingTablesCache","MAPPING_TABLES_CACHE","forEach","institutionObjet","source1","console","log","RegExp","push","hostname","message","sort","template","tLevelFacetteController","facetGroup","tlevelFacetsValues","facetName","value","includes","splice","dispoElecAutresInstController","$sce","sce","serviceName","scrollId","linkElement","category","REBUB_vue","configurationUtil","vid","REBUB_institution","match","institutionsLIst","dispos","delivery","delcategory","isShowContent","dispoElement","dispo_autres_inst","instanceAlma","toLowerCase","skin","langue","lang3","ctxTim","Date","toISOString","almaIdList","almaid","isDedup","ids_notice","idElement","openUrl","toString","templateURL","trustAsResourceUrl","$inject","customGalleryDisplayController","$element","setTimeout","firstLine","lds02","secondLine","lds01","parentElement","conteneur","querySelector","infoExElement","createElement","setAttribute","firstLineElement","innerText","appendChild","secondLineElement","itemInLoanController","date","days","result","loanDate","loandate","dueDate","duedate","today","loanDuration","calcDiffDate","formatDate","daysSinceLoanDate","_regex$exec","exec","_regex$exec2","_slicedToArray","day","month","year","firstDate","secondDate","Math","round","abs","getTime","renew","parent","children","innerHTML","renewdateok","fullMsg","fr_FR","en_US","es_ES","arguments","undefined","html","newButtonMsg","setDate","getDate","toLocaleDateString","loansService","requestParams","lang","_fullDisplayValues","maxrenewdate","authentificationAutresInstController","hostAuth","$$host","$$path","absUrl","sourceView","$$search","$stateParams","auth_base_url_const","PUDB_Auth_Lists","Boolean","usernamePasswordLoginService","showAlertMessageController","showAlertMessageConfig","affDispoController","$scope","$http","$templateCache","deliveryCategory","GetIt2","availability","holding","availabilityStatus","isValidUser","getAvailabilityStatus","locations","deliveryCode","useLinkIcon","GetThumbnailController","getThumbnailConfig","$translate","$mdToast","$rootScope","$cookies","_dismissed","$on","_toastPromise","hideCallback","ctrl","Promise","resolve","reject","then","translation","hide","show","hideDelay","position","close","response","put","controllerAs","catch","_dismiss","PrmTopbarAfterController","messageService","primoExploreCtrl"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {tLevelFacetteConfig} from './prmFacetExactAfter/customTLevelFacette';\nimport {authentificationAutresInstConfig} from './prmLoginAfter/authentificationAutresInst';\nimport {customBriefDisplayConfig} from './prmBriefResultAfter/customBriefDisplay';\nimport {customGalleryDisplayConfig} from './prmGalleryItemAfter/customGalleryDisplay';\nimport {affDispoConfig} from './prmSearchResultAvailabilityLineAfter/affDispo';\nimport {dispoElecAutresInstConfig} from './prmFullViewServiceContainerAfter/dispoElecAutresInst';\nimport {itemInLoanConfig} from './prmLoanAfter/itemInLoan';\nimport {showAlertMessageConfig} from './prmSearchBarAfter/showAlertMessage'\nimport {getThumbnailConfig} from './prmSearchResultThumbnailContainerAfter/getThumbnail';\nimport {forceAuthConfig} from './prmAuthenticationAfter/forceAuth';\nimport {logosInstsConfig} from './prmExploreFooterAfter/logosInsts';\nimport { MessageService } from './prmTopbarAfter/message.service';\nimport { PrmTopbarAfterConfig } from './prmTopbarAfter/prmTopbarAfter.component';\n\nlet app = angular.module('centralCustom',[]);\nif (app){\n    app.component('prmFacetExactAfter', tLevelFacetteConfig);\n    app.component('prmLoginAfter', authentificationAutresInstConfig);\n    app.component('prmBriefResultAfter', customBriefDisplayConfig);\n    app.component('prmGalleryItemAfter', customGalleryDisplayConfig);\n    app.component('prmSearchResultAvailabilityLineAfter', affDispoConfig);\n    app.component('prmFullViewServiceContainerAfter', dispoElecAutresInstConfig);\n    app.component('prmLoanAfter',itemInLoanConfig);\n    app.component('prmAuthenticationAfter',forceAuthConfig);\n    // app.component('prmSearchBarAfter',showAlertMessageConfig);\n    // app.component('prmSearchResultThumbnailContainerAfter',getThumbnailConfig);\n    app.component('prmExploreFooterAfter',logosInstsConfig);\n    app.service('messageService', MessageService);\n    app.component(PrmTopbarAfterConfig.name, PrmTopbarAfterConfig.config);\n} \n\n// angular.module('primo-explore.config').run(['$templateCache', function($templateCache) {\n//     $templateCache.put('components/account/loans/loan.html','<h1>Yolo !!!</h1>');\n// }]);","class forceAuthController {\n    constructor(){\n      // console.log('---->33PUDB forceauth');\n      // console.log(this);\n      // console.log(this.parentCtrl.authenticationMethods);\n      // console.log(this.parentCtrl.loginService.handleLogin());\n      var forceLogin = getQueryParam(this.parentCtrl.loginService.$location.$$absUrl, \"forcelogin\")\n      if (forceLogin == 'true'){\n        // console.log(\"redirection\");\n        let target_url = this.parentCtrl.loginService.$location.$$absUrl.replace('&forcelogin=true','')\n        target_url = encodeURIComponent(target_url);\n        let institution = this.parentCtrl.authenticationService.userSessionManagerService.inst;\n        let authenticationProfile = institution + \"_SAML_\" + institution.replace('33PUDB_','')\n        let auth_url = \"/primo_library/libweb/primoExploreLogin?institution=\"+institution+\"&lang=fr_FR&target-url=\"+target_url+\"&authenticationProfile=\"+authenticationProfile;\n        location.href = auth_url;\n      }\n      \n      // location.href = \"http://example.com\";\n      \n      function getQueryParam(url, key) {\n        var queryStartPos = url.indexOf('?');\n        if (queryStartPos === -1) {\n          return;\n        }\n        var params = url.substring(queryStartPos + 1).split('&');\n        for (var i = 0; i < params.length; i++) {\n          var pairs = params[i].split('=');\n          if (decodeURIComponent(pairs.shift()) == key) {\n            return decodeURIComponent(pairs.join('='));\n          }\n        }\n      }\n    }\n    \n  }\n  export let forceAuthConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: forceAuthController\n  }","class customBriefDisplayController {\n  constructor(){\n    // console.log('---->33PUDB customBriefDisplayController');\n    // console.log(this);\n    /******************* */\n    /* Mise en forme PCI */\n    /******************* */\n    if (this.parentCtrl.item.context == \"PC\") {\n        var firstLinetext = this.parentCtrl.otherLines;\n        // console.log(this.parentCtrl.item.pnx.display.title[0]);\n        /*Première ligne on envoie au composant les auteurs*/\n        var auteur = this.parentCtrl.item.pnx.display.creator;\n        var editeur = (typeof this.parentCtrl.item.pnx.display.publisher != \"undefined\") ? this.parentCtrl.item.pnx.display.publisher : this.parentCtrl.item.pnx.display.source;\n        var pubDate = this.parentCtrl.item.pnx.display.creationdate;\n        var ispartof = this.parentCtrl.item.pnx.display.ispartof;\n        // console.log(ispartof);\n        /*Si 2e ligne + 3e ligne ispartog généré par PCI c'est le bordel.*/\n        /*TODO : à creuser*/\n        if (typeof ispartof == \"undefined\"){\n            var adresse = editeur + \" : \" + pubDate;\n            var hSecondValue = {\n                clazz : \"media-publisher\",\n                codes : [\"\"],\n                key : \"publisher\",\n                text : [adresse],\n                values : [adresse]\n            };\n            var hSecondLine = {\n                values : [hSecondValue],\n                delimiter : \" ; \"\n            };\n            firstLinetext.unshift(hSecondLine); \n        }\n        var hFirstValue = {\n            clazz : \"media-creator\",\n            codes : [\"\"],\n            key : \"creator\",\n            text : auteur,\n            values : auteur\n        };\n        var hFirstLine = {\n            values : [hFirstValue],\n            delimiter : \" ; \"\n        };\n        // console.log(firstLinetext);\n        firstLinetext.unshift(hFirstLine);\n        }\n        // console.log(this.parentCtrl.item.pnx.control.recordid[0]);\n        // console.log(this.parentCtrl.item.context);\n        // console.log(this.parentCtrl.item.pnx.control.recordid[0]);\n        /****************************************************************************** */\n        /* Empêche l'affichage des deux champs lds01 dans le cas d'une notice fusionnée */\n        /****************************************************************************** */\n        if (this.parentCtrl.item.context == \"L\" && this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup')) {\n            // console.log(this.parentCtrl.otherLines);\n            var otherLines = this.parentCtrl.otherLines;\n            for (var i = 0; i < otherLines.length; i++) {\n                // console.log(otherLines[i].values[0].key);\n                if (otherLines[i].values[0].key == 'lds01'){\n                    var bibAddr = otherLines[i].values[0].text[0];\n                    // console.log(bibAddr);\n                    otherLines[i].values[0].text[0] = bibAddr.replace(/^(.*?)<br\\/>.*/, \"$1\");\n                }\n                if (otherLines[i].values[0].key == 'lds02'){\n                    var bibAddr = otherLines[i].values[0].text[0];\n                    // console.log(bibAddr);\n                    otherLines[i].values[0].text[0] = bibAddr.replace(/^(.*?);.*/, \"$1\");\n                }\n                \n            }\n        }\n    }\n//   get recordid() {\n//     return this.parentCtrl.item.pnx.control.recordid[0];\n//   }\n}\n\nexport let customBriefDisplayConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: customBriefDisplayController\n}","\nimport logosInstsTemplate from './logosInsts.html'\n\nclass logosInstsController {\n    constructor(){\n\n      var url = new URL(document.location.href);\n      var lang = url.searchParams.get('lang');\n      var pathname = url.pathname;\n      var displayFooter = url.searchParams.get('displayFooter');\n      var view = url.searchParams.get('vid');\n      var openUrl = url.searchParams.get('url_ver');\n      var re = /_VU./g;\n      var myInstitution = view.replace(re,\"\"); \n      this.institutionsList = [];\n      this.institutionsUrl = {};\n      this.displayFooter = true;\n      if (displayFooter == 'false'){\n        this.displayFooter = false;\n      }\n      this.parentCtrl.mappingTablesCache.MAPPING_TABLES_CACHE['Alma Institution Codes'].forEach((institutionObjet)=>{\n        var institution = institutionObjet.source1;\n        console.log(institution);\n        if (institution != \"33PUDB_NETWORK\") {\n          var regex = new RegExp(myInstitution, \"g\");\n          this.institutionsList.push(institution);\n          this.institutionsUrl[institution] = 'https://'+ url.hostname + 'search?vid=' + institution + '_VU1';\n        \n        }\n       \n      });\n      \n      this.message = \"Réseau des bibliothèques universitaires bordelaises\";    \n      \n      this.institutionsList.sort();\n\n  }\n};\n// logosInstsController.$inject = ['$http','$element','$sce'];\nexport let logosInstsConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: logosInstsController,\n    template:logosInstsTemplate\n  }\n  ","\n/*[33PUDB_NETWORK_AFA] - Customisation de la toplevel facette  */\n/*Suprime les entrées 'peer_reviewed','open_access'et'available'*/\nclass tLevelFacetteController {\n  constructor(){\n    console.log('----> 33PUDB tLevelFacetteController');\n    /*Filtre sur la top level facette*/\n    if (this.parentCtrl.facetGroup.name == \"tlevel\"){\n        /*Récupère les valeurs de la tlevel facette*/\n        var tlevelFacetsValues = this.parentCtrl.facetGroup.values;\n        // console.log(tlevelFacetsValues);\n        /*Parcours du tableau des valeurs*/\n        for (var i = 0; i < tlevelFacetsValues.length; i++) {\n            /*Récupère le nom de la facette*/\n            var facetName = tlevelFacetsValues[i].value;\n            // console.log(facetName);\n            /*On supprime les entrées relatives à la tlevel*/\n            if (['peer_reviewed', 'open_access', 'available'].includes(facetName)) {\n                tlevelFacetsValues.splice(i, 1);\n                i = i - 1;\n                // console.log(\"Supprimée\");\n            }\n        }\n    }\n  }\n\n  get recordid() {\n    return this.parentCtrl.item.pnx.control.recordid[0];\n  }\n}\n\nexport let tLevelFacetteConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: tLevelFacetteController\n}\n","/*[33PUDB_NETWORK_AFA] - Affiche la disponibilité des RE dans une autre institution*/\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Marc7167182610004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20de%20droit&offset=0\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Unimarc7157521910004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20fran%C3%A7aise%20de%20gestion\nimport dispoElecAutresInstHTML from './dispoElecAutresInst.html'\n\nclass dispoElecAutresInstController {\n  constructor($sce) {\n    console.log(this);\n    this.sce = $sce;\n    /* Parfois les services ne sont pas passés au controleur parent...*/\n    if (typeof this.parentCtrl.service !== 'undefined'){\n      this.serviceName = this.parentCtrl.service.scrollId;\n      /*On ne travaille qu'au niveau du view it*/\n      if (this.serviceName == \"getit_link1_0\" && this.parentCtrl.service.linkElement.category == \"Alma-E\") {\n        // console.log('---->dispoElecAutresInstController');\n        //Vue actuelle\n        this.REBUB_vue = this.parentCtrl.configurationUtil.vid;\n        //Je récupère le code de l'institution\n        this.REBUB_institution = this.parentCtrl.configurationUtil.vid.match(/(33PUDB_\\S+?)_/)[1];\n        this.institutionsLIst = [];\n        this.dispos = this.parentCtrl.item.pnx.delivery.delcategory;\n        this.isShowContent = {};\n        // console.log(this);\n        //Je construit une liste avec chaque institution proposant l'accès électronique au documment (pnx/delivery/delcategory)\n        for (var i = 0; i < this.dispos.length; i++) {\n          var dispoElement = this.dispos[i].match(/(\\$\\$V|^)(.*?)\\$\\$I(.*?)(\\$|$)/);\n          if (dispoElement[2] == \"Alma-E\" && dispoElement[3] != this.REBUB_institution && dispoElement[3] != \"33PUDB_NETWORK\") {\n            this.institutionsLIst.push(dispoElement[3]);\n            this.isShowContent[dispoElement[3]] = false;\n          }\n        }\n        this.dispo_autres_inst = this.institutionsLIst.length > 0 ? true : false;\n        // console.log(this.institutionsLIst);\n      }\n    }\n  }\n\n  showComponent(institution) {\n\n    /*Construction de l'Open Url*/\n    /************************** */\n    var instanceAlma = institution.match(/33PUDB_(.*)/)[1].toLowerCase();\n    var skin = institution + '_VU1';\n    var langue = this.parentCtrl.item.lang3 ? this.parentCtrl.item.lang3 : \"fre\";\n    var date = new Date();\n    var ctxTim = date.toISOString();\n    /*On récupère l'identifiant des notices Alma*/\n    var almaIdList = this.parentCtrl.item.pnx.control.almaid;\n    var isDedup = this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup');\n    var ids_notice = [];\n    for (var i = 0; i < almaIdList.length; i++) {\n      /*Si la notice est fusionnée, les idAlma sont affichés comme ça : $$V33PUDB_NETWORK:7167176110004671$$O33PUDB_Alma_Marc7167176110004671\n      On extrait l'identifiant et on filtre les notices électroniques (Alma_Marc)*/\n      if (isDedup){\n        var idElement = almaIdList[i].match(/\\$\\$V(.*?)\\$\\$O.*?_.*?_(.*?)\\d/);\n        if (idElement[2] == 'Marc'){\n          ids_notice.push('ie=' + idElement[1]);\n        }\n      }\n      else{\n        ids_notice.push('ie=' + almaIdList[i]);\n      }\n    }\n    this.openUrl = \"https://pudb-\" + instanceAlma\n                   + \".userservices.exlibrisgroup.com/view/uresolver/\"\n                   + institution \n                   + \"/openurl?ctx_enc=info:ofi/enc:UTF-8&ctx_id=10_1&ctx_tim=\" \n                   + ctxTim \n                   + \"&ctx_ver=Z39.88-2004&url_ctx_fmt=info:ofi/fmt:kev:mtx:ctx&url_ver=Z39.88-2004&rfr_id=info:sid/primo.exlibrisgroup.com-33PUDB_Alma_Marc&req_id=&rft_dat=\" \n                   + ids_notice.toString() \n                   + \",language=\" \n                   + langue\n                   + \",view=\" \n                   + this.REBUB_vue\n                   + \"&svc_dat=viewit&u.ignore_date_coverage=true&is_new_ui=true&Force_direct=false&req.skin=\" \n                   + skin;\n    /*Masquage/Affichage  de l'iframe*/\n    /******************************** */\n    for (var i in this.isShowContent) {\n      // console.log(i);\n      if(i != institution){\n        this.isShowContent[i] = false;  \n      }\n    }\n    this.isShowContent[institution] = !this.isShowContent[institution];\n    this.templateURL = 'custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/bouttonAfficheDispoElec.html';\n    // console.log(this.isShowContent);\n\n  }\n  trustAsUrl(url){\n    return this.sce.trustAsResourceUrl(url);\n  }\n}\n\ndispoElecAutresInstController.$inject = ['$sce'];\n\nexport let dispoElecAutresInstConfig = {\n  bindings: { parentCtrl: '<' },\n  controller: dispoElecAutresInstController,\n  template: dispoElecAutresInstHTML\n}","\nclass customGalleryDisplayController {\n    constructor($element){\n      setTimeout (()=>{\n        this.$element = $element;\n        // this.$document = $document;\n         console.log('---->33PUDB customGalleryDisplayController');\n         console.log(this);\n         var firstLine = this.parentCtrl.item.pnx.display.lds02;\n         var secondLine = this.parentCtrl.item.pnx.display.lds01;\n         console.log(this.$element[0].parentElement);\n         var conteneur = this.$element[0].parentElement.querySelector('div.item-info');\n         var infoExElement = document.createElement('div');\n         infoExElement.setAttribute('class','infoEx')\n         var firstLineElement = document.createElement('p');\n         firstLineElement.setAttribute('class','firstLine');\n         firstLineElement.innerText = firstLine;\n         infoExElement.appendChild(firstLineElement);\n         var secondLineElement = document.createElement('p');\n         secondLineElement.setAttribute('class','secondLine');\n         secondLineElement.innerText = secondLine;\n         infoExElement.appendChild(secondLineElement);\n         conteneur.appendChild(infoExElement);\n      }, 1000);\n    }\n  }\n\n  customGalleryDisplayController.$inject = ['$element'];\n  \n  export let customGalleryDisplayConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: customGalleryDisplayController,\n  }","class itemInLoanController { \n    constructor($element){\n        console.log(\"--->itemInLoanController\");\n        // console.log(this);\n        var loanDate = this.parentCtrl.item.loandate;\n        var dueDate = this.parentCtrl.item.duedate;\n        var today = new Date();\n        var loanDuration = calcDiffDate(formatDate(dueDate), formatDate(loanDate))\n        var daysSinceLoanDate = calcDiffDate(today, formatDate(loanDate));\n        // console.log(\"Exemplaire emprunté le \"+loanDate +\". A rendre le \"+dueDate+\".\");\n        // console.log(\"Durée du prêt :\"+loanDuration);\n        // Si la durée du prêt est supérieure à 7 jours\n        if (loanDuration > 7 && this.parentCtrl.item.renew === \"Y\"){\n            if( daysSinceLoanDate < 7) {\n                this.parentCtrl.item.renew = \"N\";\n                $element.parent().children()[0].children[4].innerHTML = newButtonMsg(addDays(today,daysSinceLoanDate),this.parentCtrl.loansService.requestParams.lang);\n            } \n        }\n        // On vide l'affichage détaillé et on ne conserve que la dated'emprunt \n        this.parentCtrl.item._fullDisplayValues = [ {key : \"loan_date\", value : this.parentCtrl.item.loandate},\n                                                    {key : \"max_renew_date\", value : this.parentCtrl.item.maxrenewdate}];\n\n\n    \n        \n        function formatDate(date){\n            var regex = /(\\d{2})\\/(\\d{2})\\/(\\d{4})/;\n            var [,day, month, year] = regex.exec(date)\n            var formatedDate = new Date(year, month - 1 , day);\n            // console.log(formatedDate);\n            return formatedDate;\n        }\n        function calcDiffDate(firstDate, secondDate){\n            var oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds    \n            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));\n            // console.log(diffDays);\n            return diffDays\n        }\n        function addDays(date,days){\n            var result = new Date();\n            // console.log(date+\" + \"+days);\n            result.setDate(date.getDate() + (7-days));\n            return result.toLocaleDateString();\n        }\n        function newButtonMsg(renewdateok,lang = 'fr_FR'){\n            var msg = {\n                \"fr_FR\" : \"Prolongation impossible avant le \",\n                \"en_US\" : \"Not renewable before \",\n                \"es_ES\" : \"No renovable hasta \"\n            };\n            var fullMsg = msg[lang] + renewdateok;\n            var html = '<div class=\"not-renewable weak-text layout-align-start-center\" aria-label=\"' + fullMsg;\n            html = html + ' aria-hidden=\"false\" layout-align=\"start center\"><prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"lock\"><!----><md-icon ng-if=\"!$ctrl.isCustom\" md-svg-icon=\"primo-ui:lock\" alt=\"\" class=\"md-primoExplore-theme\" aria-hidden=\"true\"><svg id=\"lock\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"1320\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"><path d=\"M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z\"></path>   </svg></md-icon><!----><!----><prm-icon-after parent-ctrl=\"$ctrl\"></prm-icon-after></prm-icon><span>';\n            html = html + fullMsg + '</span><!----></div><!---->';\n            return html;\n        }\n    }\n\n}\nitemInLoanController.$inject = ['$element'];\nexport let itemInLoanConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: itemInLoanController\n}","import authentificationForm from './authentificationAutresInst.html'\n\nclass authentificationAutresInstController {\n    constructor() {\n        //Debug\n        // console.log('---->33PUDB authentificationAutresInstController');\n        //DEBUG\n        // console.log(this);\n        //On recupere le host\n        this.hostAuth = this.parentCtrl.$location.$$host;\n        // console.log(\"hostAuth:\" + this.hostAuth);\n        //On récupère l'URL de départ :\n        //[AFA Patch 20/02/2019 : https://trello.com/c/Vsm7VgdA ] On teste le chemin car quand on arrive de l'extérieur et que la page ciblée demande une authentification fournie $$absurl est l'url de l'écran de login. Pour l'instant les seuls liens externes de cetypes pointent vers le compte lecteur. Donc si $$absUrl pointe vers l'écran de login on redirge vers  \n        if (this.parentCtrl.$location.$$path == \"/login\") {\n            this.absUrl = 'https://' + this.hostAuth + '/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n            //URL pour le travail en localhost\n            // this.absUrl = 'https://babordplus.hosted.exlibrisgroup.com/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n        }\n        else {\n            this.absUrl = this.parentCtrl.$location.$$absUrl;\n        }\n        //On encode correctement l'URL targeturl \n        this.absUrl = encodeURIComponent(this.absUrl);\n        // console.log(\"absUrl:\" + this.absUrl);\n        //On recupere le code vue source\n        this.sourceView = this.parentCtrl.$location.$$search.vid;\n        // console.log(\"sourceView:\" + this.sourceView);\n        //On récupére la langue de la session\n        this.langue = this.parentCtrl.$stateParams.lang;\n        //On contruit le debut de l'url pour l authentification\n        this.auth_base_url_const = 'https://' + this.hostAuth + '/primo_library/libweb/primoExploreLogin?institution=';\n        //URL Pour tester en local\n        // this.auth_base_url_const = 'https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/primoExploreLogin?institution=' ;\n        //Parcours d'une liste asso pour afficher auth IdP supplementaires\n        this.PUDB_Auth_Lists =  [\n                                    [\"1\", \"33PUDB_BXSA\", \"33PUDB_BXSA_SAML_BXSA\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_BXSA_VU1\"), \"33PUDB_BXSA_VU1\", \"Bordeaux Sciences Agro\"], \n                                    [\"2\", \"33PUDB_IEP\", \"33PUDB_IEP_SAML_IEP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_IEP_VU1\"), \"33PUDB_IEP_VU1\", \"Bordeaux Sciences Po\"],\n                                    [\"3\", \"33PUDB_UB\", \"33PUDB_UB_SAML_UB\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UB_VU1\"), \"33PUDB_UB_VU1\", \"Université de Bordeaux\"],\n                                    [\"4\", \"33PUDB_UBM\", \"33PUDB_UBM_SAML_UBM\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UBM_VU1\"), \"33PUDB_UBM_VU1\", \"Université Bordeaux Montaigne\"], \n                                    [\"5\", \"33PUDB_INP\", \"33PUDB_INP_SAML_INP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_INP_VU1\"), \"33PUDB_INP_VU1\", \"Bordeaux INP\"]];\n    }\n\n    setIdPShow(institution) {\n        //Le lien n'est pas proposé pour l'inst\n        // console.log(institution);\n        return Boolean(this.parentCtrl.usernamePasswordLoginService.inst !== institution);\n\n    }\n}\n\nexport let authentificationAutresInstConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: authentificationAutresInstController,\n    template: authentificationForm\n}","\nimport showAlertMessageHTML from './showAlertMessage.html'\nclass showAlertMessageController {\n    constructor($element){\n      console.log(\"--> show alert message !\");\n      console.log(this);\n    }\n  }\n\n  showAlertMessageController.$inject = ['$element'];\n  \n  export let showAlertMessageConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: showAlertMessageController,\n    template: showAlertMessageHTML\n  }","\nimport affDispo from './affDispo.html'\n//http://localhost:8003/primo-explore/search?query=any,contains,33PUDB_Alma_Unimarc7156806840004671%20OR%2033PUDB_Alma_Unimarc7180719980004671&tab=default_tab&search_scope=catalog_pci&vid=33PUDB_UBM_VU1&lang=en_US&offset=0\n//Cf. case Exlib # 00641786\n//Remonte la deuxième mention de disponibilté qui est parfois non affichée quand notices imprimés et électroniques ont été fusionnées \nclass affDispoController {\n  constructor($scope, $http, $element, $templateCache){\n    console.log('---->affDispoController');\n    if (this.parentCtrl.result.pnx.control.recordid[0].startsWith('dedup')){\n      // console.log(this.parentCtrl.result.pnx.display.title);\n      // console.log(this.parentCtrl.result.delivery);\n      if (this.parentCtrl.result.delivery.deliveryCategory.length == 1){\n        if (typeof this.parentCtrl.result.delivery.GetIt2 !== 'undefined') {\n          console.log('---->affDispoController : recalcule de la disponibilité');\n          var availability = getAvailabilityStatus(this.parentCtrl.result.delivery.holding);\n          this.locations = [];\n          this.locations.push({\n            availability: availability,\n            deliveryCode: 'delivery.code.'+ availability,\n            // toTranslate: productionVID(window.appConfig.vid),\n            useLinkIcon: true,\n            // outboundLink: illLink(pnx),\n          })\n      }\n      console.log(this.locations);\n      }\n    }\n    function getAvailabilityStatus(holding){\n      console.log(holding);\n      if (typeof holding == 'undefined' || holding == null) {\n        return \"unavailable_in_all_institutions\";\n      }\n      var availabilityStatus = [];\n      for (var i = 0; i < holding.length; i++) {\n        if (holding[i].isValidUser){\n          availabilityStatus.push(holding[i].availabilityStatus);  \n        }\n      }\n      if (availabilityStatus.length == 0){\n          return \"does_not_exist_in_maininstitution\";\n      }\n      else{\n        if (availabilityStatus.includes('available')){\n          return \"available_in_maininstitution\";\n        }\n        else {\n          return \"check_holdings\";\n        }\n      }\n    }\n    console.log(this);\n  }\n}\naffDispoController.$inject = ['$scope', '$http', '$element', '$templateCache' ]\nexport let affDispoConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: affDispoController,\n  template: affDispo\n}\n","import GetThumbnailTemplate from './getThumbnail.html'\n/*\n * getThumbnail.controller.js\n *9782070582617\n */\nclass GetThumbnailController {\n  /*@ngInject*/\n  constructor($http,$element) {\n      this.$http = $http;\n      this.$element = $element;\n\n      console.log(\"---->thumbnail link\");\n      console.log(this.parentCtrl);\n      \n  };\n  $onInit() {\n    // 2-36847-501-X\n    // console.log(this.parentCtrl);\n    // if (this.selectedThumbnailLink.isDefault){\n    //   this.selectedThumbnailLink.linkURL=\"https://books.google.com/books/content?id=ou1iDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl\";\n    //   console.log(\"truc\");\n    // }\n    // console.log(this.parentCtrl);\n\n  }\n// getToken() {\n//   console.log('gettoken');\n//   var sessionStorage = this.parentCtrl.searchService.jwtUtilService.storageUtil.sessionStorage;\n//   var electreToken = this.$http.get('http://127.0.0.1:5000/token')\n//                   .then(function mySuccess(response) {\n//                     // console.log(response);\n//                       if (response.data != undefined) {\n//                           console.log(response.data);\n//                           var timestamp = Math.round(new Date() / 1000);\n//                           var token_validity = timestamp + response.data.expires_in\n//                           sessionStorage.setItem('33PUDB_thumbnail_token',response.data.access_token);\n//                           sessionStorage.setItem('33PUDB_thumbnail_token_expire_in',token_validity);\n//                           return response.data;\n//                           }\n//                   }, function myError(response) {\n//                       console.log(\"ERREUR\");\n//                       var timestamp = Math.round(new Date() / 1000);\n//                       var token_validity = timestamp + 3600\n//                       sessionStorage.setItem('33PUDB_thumbnail_token_expire_in',token_validity);\n//                       sessionStorage.setItem('33PUDB_thumbnail_token','Error');\n//                       return response.data;\n                      \n//                   }); \n//   console.log(electreToken);\n//   return electreToken;\n// }\n// setUrlThumbnail(isbn) {\n//   var access_token = this.parentCtrl.searchService.jwtUtilService.storageUtil.sessionStorage.getItem('33PUDB_thumbnail_token');\n//   console.log('setUrlThumbnail');\n//   if (isbn.length === 13){\n//     if (! this.electreThumbnailLink ){\n//       console.log('Isbn : ' + isbn);\n//       // this.electreThumbnailLink = \"https://electre3staging-api.bvdep.com/v1.0/eans/\" + isbn + \"/cover?access_token=\" + access_token;\n//       var electreEanLink = \"https://electre3staging-api.bvdep.com/v1.0/eans/\" + isbn + \"?access_token=\" + access_token;\n//       console.log('this is');\n//       console.log(this);\n//       this.$http.get(electreEanLink)\n//           .then(function mySuccess(response) {\n//               console.log(response.data);\n//               if (response.data != undefined) {\n//                   console.log(\"Papayou\")\n//                   console.log(response.data._links[0].href);\n//                   console.log(this);\n//                   this.electreThumbnailLink = response.data._links[0].href;\n//                   this.$element.parent().children()[0].style.display = \"none\";\n//                   }\n//           }, function myError(response) {\n//               console.log(\"Erreur\");\n//               var timestamp = Math.round(new Date() / 1000);\n//               return \"Error\";\n//               // sessionStorage.setItem('33PUDB_thumbnail_token_expire_in',token_validity);\n//               // sessionStorage.setItem('33PUDB_thumbnail_token','Mince');\n              \n              \n//           }); \n//     }\n//   }\n\n   \n  \n// }\n};\nGetThumbnailController.$inject = ['$http','$element'];\n\nexport let getThumbnailConfig = {\n  bindings: { parentCtrl: '<' },\n  controller: GetThumbnailController,\n  template: GetThumbnailTemplate\n}","/**\n * Annoncement service.\n * Displays a md-toast on top of the view, containing an announcement retrieved from the code tables.\n */\nexport class MessageService {\n  constructor($translate, $mdToast, $rootScope, $cookies) {\n    this.$translate = $translate;\n    this.$mdToast = $mdToast;\n    this.$rootScope = $rootScope;\n    this.$cookies = $cookies;\n\n    this._dismissed = false;\n\n    // Forget the dismissal if the language is changed.\n    this.$rootScope.$on('$translateChangeSuccess', () => {\n      this._dismissed = false;\n    });\n    console.log(\"--> MESSAGE !!!\");\n    console.log(this);\n  };\n\n  // The announcement has been dismissed.\n  _dismiss() {\n    this._dismissed = true;\n    this._toastPromise = null;\n  };\n\n  /**\n   *  Displays the announcement if it has not been dismissed.\n   *  @param {function} [hideCallback] - A function to be called\n   *    when the announcement is hidden.\n   *  @return {Promise} A Promise to be fulfilled\n   *    if the announcement is displayed, and to be\n   *    rejected when the announcement cannot be displayed.\n   */\n  display(hideCallback) {\n    let ctrl = this;\n\n    return new Promise((resolve, reject) => {\n\n      if (ctrl._dismissed === true) {\n        reject('The announcement has been dismissed.');\n        return;\n      }\n\n      ctrl.$translate('default.nui.message.annoucement').then((translation) => {\n        console.log('YOplà !!!');\n        // Check if there is a cookie with this message\n        let cookie = ctrl.$cookies.get('announcement');\n        if (cookie === translation) {\n          reject('The announcement has been dismissed before.');\n          return;\n        }\n        // If there is no announcement to be displayed.\n        if ((!translation) || ['announcement', '&nbsp;', ''].includes(translation)) {\n          // translation is assigned 'announcement' in the absence of a matching entry.\n\n          // If there is already a toast, and no \n          // announcement, hide the toast.\n          // This happens when the language is changed.\n          if (ctrl._toastPromise && !ctrl._dismissed) {\n            ctrl.$mdToast.hide();\n          }\n          reject('Pas de message trouvé .');\n          return;\n        }\n\n        // If there is already a toast promise,\n        // avoid creating a new one.\n        ctrl._toastPromise = ctrl._toastPromise || ctrl.$mdToast.show({\n          // Timeout duration in msecs. false implies no timeout.\n          hideDelay: false,\n          position: 'top',\n          controller: () => {\n            return {\n              close: () => {\n                ctrl.$mdToast.hide();\n                // Save as cookie\n                ctrl.$translate('default.nui.message.annoucement').then((response) => {\n                  return ctrl.$cookies.put('announcement', response);\n                });\n              }\n            }\n          },\n          controllerAs: '$ctrl',\n          template: `\n  <md-toast class=\"page-notification\" style=\"top: 0px; position: sticky !important;\">\n      <div class=\"md-toast-content\" style=\"box-shadow:none; width: 100%;\">\n          <span class='md-toast-text' flex translate='nui.message.announcement'>\n    </span>\n      </div>\n      <a class=\"close\" ng-click='$ctrl.close()' aria-label=\"{{'nui.message.dismiss' | translate}}\"\n         style=\"position: absolute; right: 1.5rem; top: 1.5rem;\">\n          <prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"close\">\n          </prm-icon>\n      </a>\n  </md-toast>\n            `,\n        });\n\n        ctrl._toastPromise.then(hideCallback).catch(hideCallback).then(() => ctrl._dismiss());\n\n        resolve();\n\n      });\n\n    });\n  };\n\n};\n\nMessageService.$inject = ['$translate', '$mdToast', '$rootScope', '$cookies'];","class PrmTopbarAfterController {\n    constructor(messageService, $scope, $element, $translate) {\n      this.messageService = messageService;\n      this.$scope = $scope;\n      this.$element = $element;\n      this.$translate = $translate;\n    }\n  \n    $onInit() {\n      // message displayed.\n      this.messageService.display()\n        .catch((e) => {\n          if (e) console.log(e);\n        });\n    };\n  }\n  \n  PrmTopbarAfterController.$inject = ['messageService', '$scope', '$element', '$translate'];\n  \n  export let PrmTopbarAfterConfig = {\n    name: 'prmTopbarAfter',\n    config: {\n      controller: PrmTopbarAfterController,\n      require: {\n        primoExploreCtrl: '^primoExplore'\n      }\n    }\n  };"],"sourceRoot":"/source/"}