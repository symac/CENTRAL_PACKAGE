{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/CENTRAL_PACKAGE/js/main.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmAuthenticationAfter/forceAuth.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmBriefResultAfter/customBriefDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmCollectionNavigationBreadcrumbsAfter/changeLinkToCollectionDiscovery.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmExploreFooterAfter/logosInsts.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFacetExactAfter/customTLevelFacette.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/dispoElecAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmGalleryItemAfter/customGalleryDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoanAfter/itemInLoan.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoginAfter/authentificationAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchResultAvailabilityLineAfter/affDispo.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmUserAreaExpandableAfter/panier.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","actions","_customTLevelFacette","_authentificationAutresInst","_customBriefDisplay","_customGalleryDisplay","_affDispo","_dispoElecAutresInst","_itemInLoan","_forceAuth","_logosInsts","_panier","_changeLinkToCollectionDiscovery","app","angular","getZoterobibq","addata","risformattype","linktopnx","isbn","doi","pmid","lad21","toString","replace","component","tLevelFacetteConfig","authentificationAutresInstConfig","customBriefDisplayConfig","customGalleryDisplayConfig","affDispoConfig","dispoElecAutresInstConfig","itemInLoanConfig","forceAuthConfig","logosInstsConfig","panierConfig","changeLinkToCollectionDiscoveryConfig","name","type","icon","set","action","service","processCustomAction","prmActionCtrl","slug","iconname","toLowerCase","index","Object","keys","actionListService","actionsToIndex","this","push","setCustomAction","actionLabelNamesMap","actionIconNamesMap","actionIcons","iconSet","requiredActionsList","actionsToDisplay","unshift","actionurl","console","log","item","zoterobibq","url","URL","document","location","href","hostname","context","pnx","control","recordid","ristype","format","hasOwnProperty","templateVar","onToggle","window","open","setCustomActionContainer","mdTabsCtrl","getCustomActions","controller","$scope","customActionService","vm","$onInit","forEach","processedAction","bindings","parentCtrl","forceAuthController","_classCallCheck","key","queryStartPos","indexOf","params","substring","split","pairs","decodeURIComponent","shift","join","getQueryParam","loginService","$location","$$absUrl","target_url","encodeURIComponent","institution","authenticationService","userSessionManagerService","inst","authenticationProfile","auth_url","customBriefDisplayController","firstLinetext","otherLines","auteur","display","creator","editeur","publisher","source","pubDate","creationdate","ispartof","adresse","hSecondLine","values","clazz","codes","text","delimiter","hFirstLine","startsWith","bibAddr","changeLinkToCollectionDiscoveryController","$element","$translate","_this","view_institution","$stateParams","vid","substr","collection_institution","_breadcrumbStateParams","parent","children","setAttribute","collectionId","title","then","translation","innerText","$inject","logosInstsController","displayFooter","searchParams","get","pathname","view","myInstitution","institutionsList","institutionsUrl","mappingTablesCache","MAPPING_TABLES_CACHE","institutionObjet","source1","RegExp","message","sort","template","tLevelFacetteController","facetGroup","tlevelFacetsValues","facetName","value","includes","splice","dispoElecAutresInstController","$sce","sce","serviceName","scrollId","linkElement","category","REBUB_vue","configurationUtil","REBUB_institution","match","institutionsLIst","dispos","delivery","delcategory","isShowContent","dispoElement","dispo_autres_inst","instanceAlma","skin","langue","lang3","ctxTim","Date","toISOString","almaIdList","almaid","isDedup","ids_notice","idElement","openUrl","templateURL","trustAsResourceUrl","customGalleryDisplayController","setTimeout","firstLine","undefined","lds02","secondLine","lds01","parentElement","conteneur","querySelector","infoExElement","createElement","firstLineElement","appendChild","secondLineElement","itemInLoanController","loanDate","loandate","dueDate","duedate","today","loanDuration","calcDiffDate","formatDate","daysSinceLoanDate","ilsinstitutioncode","date","_regex$exec","exec","_regex$exec2","_slicedToArray","day","month","year","formatedDate","firstDate","secondDate","Math","round","abs","getTime","addDays","days","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","toLocaleDateString","newButtonMsg","renewdateok","fullMsg","fr_FR","en_US","es_ES","arguments","html","duree_prolongation","renew","innerHTML","loansService","requestParams","lang","_fullDisplayValues","maxrenewdate","authentificationAutresInstController","hostAuth","$$host","$$path","absUrl","sourceView","$$search","auth_base_url_const","PUDB_Auth_Lists","Boolean","usernamePasswordLoginService","affDispoController","$http","$templateCache","result","deliveryCategory","GetIt2","availability","holding","availabilityStatus","isValidUser","getAvailabilityStatus","locations","deliveryCode","useLinkIcon","panierController","element","uSMS","panierUser","isGuest","jwtData","jwtUtilService","getDecodedToken","user","panierUrl"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {tLevelFacetteConfig} from './prmFacetExactAfter/customTLevelFacette';\nimport {authentificationAutresInstConfig} from './prmLoginAfter/authentificationAutresInst';\nimport {customBriefDisplayConfig} from './prmBriefResultAfter/customBriefDisplay';\nimport {customGalleryDisplayConfig} from './prmGalleryItemAfter/customGalleryDisplay';\nimport {affDispoConfig} from './prmSearchResultAvailabilityLineAfter/affDispo';\nimport {dispoElecAutresInstConfig} from './prmFullViewServiceContainerAfter/dispoElecAutresInst';\nimport {itemInLoanConfig} from './prmLoanAfter/itemInLoan';\n// import {showAlertMessageConfig} from './prmSearchBarAfter/showAlertMessage'\n// import {getThumbnailConfig} from './prmSearchResultThumbnailContainerAfter/getThumbnail';\nimport {forceAuthConfig} from './prmAuthenticationAfter/forceAuth';\nimport {logosInstsConfig} from './prmExploreFooterAfter/logosInsts';\n// import {alertMessageConfig} from './prmBackToLibrarySearchButtonAfter/alertMessage';\nimport {panierConfig} from './prmUserAreaExpandableAfter/panier';\n// import { MessageService } from './prmTopbarAfter/message.service';\n// import { PrmTopbarAfterConfig } from './prmTopbarAfter/prmTopbarAfter.component';\nimport {changeLinkToCollectionDiscoveryConfig} from './prmCollectionNavigationBreadcrumbsAfter/changeLinkToCollectionDiscovery';\n\nlet app = angular.module('centralCustom',[]);\nif (app){\n    app.component('prmFacetExactAfter', tLevelFacetteConfig);\n    app.component('prmLoginAfter', authentificationAutresInstConfig);\n    app.component('prmBriefResultAfter', customBriefDisplayConfig);\n    app.component('prmGalleryItemAfter', customGalleryDisplayConfig);\n    app.component('prmSearchResultAvailabilityLineAfter', affDispoConfig);\n    app.component('prmFullViewServiceContainerAfter', dispoElecAutresInstConfig);\n    app.component('prmLoanAfter',itemInLoanConfig);\n    app.component('prmAuthenticationAfter',forceAuthConfig);\n    // app.component('prmSearchBarAfter',showAlertMessageConfig);\n    // app.component('prmSearchResultThumbnailContainerAfter',getThumbnailConfig);\n    app.component('prmExploreFooterAfter',logosInstsConfig);\n    // app.component('prmBackToLibrarySearchButtonAfter',alertMessageConfig);\n    // app.service('messageService', MessageService);\n    // app.component(PrmTopbarAfterConfig.name, PrmTopbarAfterConfig.config);\n    app.component('prmUserAreaExpandableAfter',panierConfig);\n    app.component('prmCollectionNavigationBreadcrumbsItemAfter',changeLinkToCollectionDiscoveryConfig);\n    // app.component('prmCollectionGalleryHeaderAfter',modifyCollectionTopTitleConfig)\n} \n\n// START ------ Primo-ZoteroBib-Add-On ------/\nfunction insertActions(actions) {\n    app.service('customActionService', function() {\n        return {\n            actions: [],\n            processCustomAction: function(prmActionCtrl, action) {\n                action.slug = action.name.replace(/\\s+/g, ''); // remove whitespace\n                action.iconname = action.slug.toLowerCase();\n                action.index = Object.keys(prmActionCtrl.actionListService.actionsToIndex).length - 1 ; // ignore \"none\" and RISPushTo\n                this.actions.push(action);\n                return action;\n            },\n            setCustomAction: function(prmActionCtrl, action) {\n                    prmActionCtrl.actionLabelNamesMap[action.slug] = action.name;\n                    prmActionCtrl.actionIconNamesMap[action.slug] = action.iconname;\n                    prmActionCtrl.actionIcons[action.iconname] = {\n                        icon: action.icon.name,\n                        iconSet: action.icon.set,\n                        type: \"svg\"\n                    };\n                    if (!prmActionCtrl.actionListService.actionsToIndex[action.slug]) { // ensure we aren't duplicating the entry\n                        prmActionCtrl.actionListService.requiredActionsList[action.index] = action.slug;\n                        prmActionCtrl.actionListService.actionsToDisplay.unshift(action.slug);\n                        prmActionCtrl.actionListService.actionsToIndex[action.slug] = action.index;\n                    }\n                    \n                    var actionurl = \"\";\n                                                        \n                    if (action.type === 'urlredirectzotero') {\n                      console.log(prmActionCtrl.item);\n                        var zoterobibq = \"0\";\n                        //Construct link to PNX record\n                        var url = new URL(document.location.href);\n                        var hostname = url.hostname;\n                         console.log(url.hostname);\n                        var context = prmActionCtrl.item.context\n                        var recordid = prmActionCtrl.item.pnx.control.recordid;\n                        var linktopnx =\"https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/webservices/rest/primo-explore/v1/pnxs/xml/\"+context+\"/\"+recordid+\"?inst=33PUDB_NETWORK%26showPnx=true\";\n                        // var linktopnx =\"https://\"+url.hostname+\"/primo_library/libweb/webservices/rest/primo-explore/v1/pnxs/xml/\"+context+\"/\"+recordid+\"?inst=33PUDB_UB%26showPnx=true\";\n                          //check is RISTYPE Exists\n                          if (typeof prmActionCtrl.item.pnx.addata.ristype == 'undefined'){\n                            console.log(\"format\" + prmActionCtrl.item.pnx.addata.format);\n                            zoterobibq = linktopnx;\n                          }else{\n                            console.log(\"format\" + prmActionCtrl.item.pnx.addata.ristype.toString().toLowerCase())\n                            switch(prmActionCtrl.item.pnx.addata.ristype.toString().toLowerCase()) {\n                              case \"book\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 0,linktopnx);\n                                break;\n                              case \"jour\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 1,linktopnx);\n                                break;\n                              case \"gen\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 2,linktopnx);\n                                break;\n                              case \"thes\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 3, linktopnx);\n                                break;\n\n                              default:\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 4, linktopnx);\n                            }\t\t\t\t\t\t\t\t\n                          }\t\t\t\t\t\t\t  \n                      if (action.hasOwnProperty('templateVar')) {\n                          action.action = action.action.replace(/{\\d}/g, function(r){return action.templateVar[r.replace(/[^\\d]/g,'')]});\n                          console.log(\"templateVar\");\n                      }\n                        actionurl = action.action + zoterobibq;\n                        console.log(actionurl);\n                    }\t\t\t\t\t\t\n                    prmActionCtrl.actionListService.onToggle[action.slug] = function(){\t\t\t\t\t\t\t\n                        window.open(actionurl, '_blank'); // opens the url in a new window\n                    };\n            },\n            setCustomActionContainer: function(mdTabsCtrl, action) { // for further review...\n            },\n            getCustomActions: function() {\n                return this.actions;\n            }\n        };\n    })\n    .component('prmActionListAfter', {\n        require: {\n            prmActionCtrl: '^prmActionList',\n        },\n        controller: 'customActionController'\n    })\n    .controller('customActionController', ['$scope', 'customActionService', function($scope, customActionService) {\n        var vm = this;\n        vm.$onInit = function() {\t\t\t\n            actions.forEach(function(action) {\n                var processedAction = customActionService.processCustomAction(vm.prmActionCtrl, action);\n                customActionService.setCustomAction(vm.prmActionCtrl, processedAction);\n                \n            });\n        };\n    }])\n}\n// END ------ Primo-VE-ZoteroBib-Add-On ------/\t\n\n\n//Replace name and icon with you own\ninsertActions([{\n    name: \"ZoteroBib\",\n    type: \"urlredirectzotero\",\n    icon: {\n        set: 'primo-actions',\n        name: 'easybib'\n    },\n    action: \"https://zbib.org/import?q=\"\n}]);\n\n\n//Place this function outside the main function\n//Function to get ISBN, DOI, PMID,arXiv ID, or title\nfunction getZoterobibq(addata, risformattype, linktopnx)\n{\n\tswitch(risformattype) {\n    case 0: // book\n    if (typeof addata.isbn !== 'undefined')\n        if(addata.isbn.length > 1)\n            return addata.isbn[0];\n        else\n            return addata.isbn;\n    return linktopnx;\n\t\tbreak;\n\t  case 1: //jour\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined')\n\t\t\treturn addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');\n    return linktopnx;\n        break;\n\t  case 2: //gen\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined')\n\t\t\treturn addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');\n    return linktopnx;\n        break;\n\t  case 3: //thesis\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined'){\n            return addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');}\n    return linktopnx;\n\t\tbreak;\n\t  default:// will use the title if no ISBN, DOI, PMID,arXiv ID\n\t\treturn linktopnx;\n\t}\n}","class forceAuthController {\n    constructor(){\n      // console.log('---->33PUDB forceauth');\n      // console.log(this);\n      // console.log(this.parentCtrl.authenticationMethods);\n      // console.log(this.parentCtrl.loginService.handleLogin());\n      var forceLogin = getQueryParam(this.parentCtrl.loginService.$location.$$absUrl, \"forcelogin\")\n      if (forceLogin == 'true'){\n        // console.log(\"redirection\");\n        let target_url = this.parentCtrl.loginService.$location.$$absUrl.replace('&forcelogin=true','')\n        target_url = encodeURIComponent(target_url);\n        let institution = this.parentCtrl.authenticationService.userSessionManagerService.inst;\n        let authenticationProfile = institution + \"_SAML_\" + institution.replace('33PUDB_','')\n        let auth_url = \"/primo_library/libweb/primoExploreLogin?institution=\"+institution+\"&lang=fr_FR&target-url=\"+target_url+\"&authenticationProfile=\"+authenticationProfile;\n        location.href = auth_url;\n      }\n      \n      // location.href = \"http://example.com\";\n      \n      function getQueryParam(url, key) {\n        var queryStartPos = url.indexOf('?');\n        if (queryStartPos === -1) {\n          return;\n        }\n        var params = url.substring(queryStartPos + 1).split('&');\n        for (var i = 0; i < params.length; i++) {\n          var pairs = params[i].split('=');\n          if (decodeURIComponent(pairs.shift()) == key) {\n            return decodeURIComponent(pairs.join('='));\n          }\n        }\n      }\n    }\n    \n  }\n  export let forceAuthConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: forceAuthController\n  }","class customBriefDisplayController {\n  constructor(){\n    // console.log('---->33PUDB customBriefDisplayController');\n    // console.log(this);\n    /******************* */\n    /* Mise en forme PCI */\n    /******************* */\n    if (this.parentCtrl.item.context == \"PC\") {\n        var firstLinetext = this.parentCtrl.otherLines;\n        // console.log(this.parentCtrl.item.pnx.display.title[0]);\n        /*Première ligne on envoie au composant les auteurs*/\n        var auteur = this.parentCtrl.item.pnx.display.creator;\n        var editeur = (typeof this.parentCtrl.item.pnx.display.publisher != \"undefined\") ? this.parentCtrl.item.pnx.display.publisher : this.parentCtrl.item.pnx.display.source;\n        var pubDate = this.parentCtrl.item.pnx.display.creationdate;\n        var ispartof = this.parentCtrl.item.pnx.display.ispartof;\n        // console.log(ispartof);\n        /*Si 2e ligne + 3e ligne ispartog généré par PCI c'est le bordel.*/\n        /*TODO : à creuser*/\n        if (typeof ispartof == \"undefined\"){\n            var adresse = editeur + \" : \" + pubDate;\n            var hSecondValue = {\n                clazz : \"media-publisher\",\n                codes : [\"\"],\n                key : \"publisher\",\n                text : [adresse],\n                values : [adresse]\n            };\n            var hSecondLine = {\n                values : [hSecondValue],\n                delimiter : \" ; \"\n            };\n            firstLinetext.unshift(hSecondLine); \n        }\n        var hFirstValue = {\n            clazz : \"media-creator\",\n            codes : [\"\"],\n            key : \"creator\",\n            text : auteur,\n            values : auteur\n        };\n        var hFirstLine = {\n            values : [hFirstValue],\n            delimiter : \" ; \"\n        };\n        // console.log(firstLinetext);\n        firstLinetext.unshift(hFirstLine);\n        }\n        // console.log(this.parentCtrl.item.pnx.control.recordid[0]);\n        // console.log(this.parentCtrl.item.context);\n        // console.log(this.parentCtrl.item.pnx.control.recordid[0]);\n        /****************************************************************************** */\n        /* Empêche l'affichage des deux champs lds01 dans le cas d'une notice fusionnée */\n        /****************************************************************************** */\n        if (this.parentCtrl.item.context == \"L\" && this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup')) {\n            // console.log(this.parentCtrl.otherLines);\n            var otherLines = this.parentCtrl.otherLines;\n            for (var i = 0; i < otherLines.length; i++) {\n                // console.log(otherLines[i].values[0].key);\n                if (otherLines[i].values[0].key == 'lds01'){\n                    var bibAddr = otherLines[i].values[0].text[0];\n                    // console.log(bibAddr);\n                    otherLines[i].values[0].text[0] = bibAddr.replace(/^(.*?)<br\\/>.*/, \"$1\");\n                }\n                if (otherLines[i].values[0].key == 'lds02'){\n                    var bibAddr = otherLines[i].values[0].text[0];\n                    // console.log(bibAddr);\n                    otherLines[i].values[0].text[0] = bibAddr.replace(/^(.*?);.*/, \"$1\");\n                }\n                \n            }\n        }\n    }\n//   get recordid() {\n//     return this.parentCtrl.item.pnx.control.recordid[0];\n//   }\n}\n\nexport let customBriefDisplayConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: customBriefDisplayController\n}","class changeLinkToCollectionDiscoveryController {\n    // \n\n    constructor($element, $translate) {\n        this.$translate = $translate;\n        this.$element = $element;\n\n\n        var view_institution = this.parentCtrl.$stateParams.vid.substr(0, this.parentCtrl.$stateParams.vid.length - 4 );\n        var collection_institution = this.parentCtrl._breadcrumbStateParams.inst ? this.parentCtrl._breadcrumbStateParams.inst : view_institution;\n        console.log(view_institution + \"/\" + collection_institution);\n        console.log(this)\n        console.log( this.$element.parent().children()[0]);\n        //Si l'institution de la vue n'est pas la même que celle de la collection on modifie la vue dans le lien de redirection \n        // pour renvoyer vers la vue de l'institution propriétaire de la collection.\n        if (view_institution != collection_institution){\n\n            this.parentCtrl._breadcrumbStateParams.vid = collection_institution + '_VU1';\n            //On force le rechargemene de la page pour appliquer le changement de vue \n            this.$element.parent().children()[0].setAttribute(\"target\", \"_self\");\n        }\n        \n\n        //On ajoute le nom de l'institution propriétaire de la collection au niveau du lien de premier niveau  \n        if (typeof this.parentCtrl._breadcrumbStateParams.collectionId === \"undefined\" && typeof this.parentCtrl.$stateParams.collectionId === \"undefined\") {\n            let title;\n            this.$translate('nui.colldiscovery.lobby.linktitle.'+ this.parentCtrl.institution).then((translation) => {\n                title = translation\n                console.log(title);\n                this.$element.parent().children()[0].children[0].innerText = title;\n               \n            });\n           \n            // 33PUDB_UB.nui.colldiscovery.lobby.toptitle\n        }\n\n    }\n;\n}\nchangeLinkToCollectionDiscoveryController.$inject = ['$element', '$translate'];\nexport let changeLinkToCollectionDiscoveryConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: changeLinkToCollectionDiscoveryController\n}","\nimport logosInstsTemplate from './logosInsts.html'\n\nclass logosInstsController {\n    constructor(){\n\n      var url = new URL(document.location.href);\n      var lang = url.searchParams.get('lang');\n      var pathname = url.pathname;\n      var displayFooter = url.searchParams.get('displayFooter');\n      var view = url.searchParams.get('vid');\n      var openUrl = url.searchParams.get('url_ver');\n      var re = /_VU./g;\n      var myInstitution = view.replace(re,\"\"); \n      this.institutionsList = [];\n      this.institutionsUrl = {};\n      this.displayFooter = true;\n      if (displayFooter == 'false'){\n        this.displayFooter = false;\n      }\n      this.parentCtrl.mappingTablesCache.MAPPING_TABLES_CACHE['Alma Institution Codes'].forEach((institutionObjet)=>{\n        var institution = institutionObjet.source1;\n        console.log(institution);\n        if (institution != \"33PUDB_NETWORK\") {\n          var regex = new RegExp(myInstitution, \"g\");\n          this.institutionsList.push(institution);\n          this.institutionsUrl[institution] = 'https://'+ url.hostname + '/primo-explore/search?vid=' + institution + '_VU1';\n        \n        }\n       \n      });\n      \n      this.message = \"Réseau des bibliothèques universitaires bordelaises\";    \n      \n      this.institutionsList.sort();\n\n  }\n};\n// logosInstsController.$inject = ['$http','$element','$sce'];\nexport let logosInstsConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: logosInstsController,\n    template:logosInstsTemplate\n  }\n  ","\n/*[33PUDB_NETWORK_AFA] - Customisation de la toplevel facette  */\n/*Suprime les entrées 'peer_reviewed','open_access'et'available'*/\nclass tLevelFacetteController {\n  constructor(){\n    console.log('----> 33PUDB tLevelFacetteController');\n    /*Filtre sur la top level facette*/\n    if (this.parentCtrl.facetGroup.name == \"tlevel\"){\n        /*Récupère les valeurs de la tlevel facette*/\n        var tlevelFacetsValues = this.parentCtrl.facetGroup.values;\n        // console.log(tlevelFacetsValues);\n        /*Parcours du tableau des valeurs*/\n        for (var i = 0; i < tlevelFacetsValues.length; i++) {\n            /*Récupère le nom de la facette*/\n            var facetName = tlevelFacetsValues[i].value;\n            // console.log(facetName);\n            /*On supprime les entrées relatives à la tlevel*/\n            if (['peer_reviewed', 'open_access', 'available'].includes(facetName)) {\n                tlevelFacetsValues.splice(i, 1);\n                i = i - 1;\n                // console.log(\"Supprimée\");\n            }\n        }\n    }\n  }\n\n  get recordid() {\n    return this.parentCtrl.item.pnx.control.recordid[0];\n  }\n}\n\nexport let tLevelFacetteConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: tLevelFacetteController\n}\n","/*[33PUDB_NETWORK_AFA] - Affiche la disponibilité des RE dans une autre institution*/\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Marc7167182610004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20de%20droit&offset=0\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Unimarc7157521910004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20fran%C3%A7aise%20de%20gestion\nimport dispoElecAutresInstHTML from './dispoElecAutresInst.html'\n\nclass dispoElecAutresInstController {\n  constructor($sce) {\n    console.log(this);\n    this.sce = $sce;\n    /* Parfois les services ne sont pas passés au controleur parent...*/\n    if (typeof this.parentCtrl.service !== 'undefined'){\n      this.serviceName = this.parentCtrl.service.scrollId;\n      /*On ne travaille qu'au niveau du view it*/\n      if (this.serviceName == \"getit_link1_0\" && this.parentCtrl.service.linkElement.category == \"Alma-E\") {\n        // console.log('---->dispoElecAutresInstController');\n        //Vue actuelle\n        this.REBUB_vue = this.parentCtrl.configurationUtil.vid;\n        //Je récupère le code de l'institution\n        this.REBUB_institution = this.parentCtrl.configurationUtil.vid.match(/(33PUDB_\\S+?)_/)[1];\n        this.institutionsLIst = [];\n        this.dispos = this.parentCtrl.item.pnx.delivery.delcategory;\n        this.isShowContent = {};\n        // console.log(this);\n        //Je construit une liste avec chaque institution proposant l'accès électronique au documment (pnx/delivery/delcategory)\n        for (var i = 0; i < this.dispos.length; i++) {\n          var dispoElement = this.dispos[i].match(/(\\$\\$V|^)(.*?)\\$\\$I(.*?)(\\$|$)/);\n          if (dispoElement[2] == \"Alma-E\" && dispoElement[3] != this.REBUB_institution && dispoElement[3] != \"33PUDB_NETWORK\") {\n            this.institutionsLIst.push(dispoElement[3]);\n            this.isShowContent[dispoElement[3]] = false;\n          }\n        }\n        this.dispo_autres_inst = this.institutionsLIst.length > 0 ? true : false;\n        // console.log(this.institutionsLIst);\n      }\n    }\n  }\n\n  showComponent(institution) {\n\n    /*Construction de l'Open Url*/\n    /************************** */\n    var instanceAlma = institution.match(/33PUDB_(.*)/)[1].toLowerCase();\n    var skin = institution + '_VU1';\n    var langue = this.parentCtrl.item.lang3 ? this.parentCtrl.item.lang3 : \"fre\";\n    var date = new Date();\n    var ctxTim = date.toISOString();\n    /*On récupère l'identifiant des notices Alma*/\n    var almaIdList = this.parentCtrl.item.pnx.control.almaid;\n    var isDedup = this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup');\n    var ids_notice = [];\n    for (var i = 0; i < almaIdList.length; i++) {\n      /*Si la notice est fusionnée, les idAlma sont affichés comme ça : $$V33PUDB_NETWORK:7167176110004671$$O33PUDB_Alma_Marc7167176110004671\n      On extrait l'identifiant et on filtre les notices électroniques (Alma_Marc)*/\n      if (isDedup){\n        var idElement = almaIdList[i].match(/\\$\\$V(.*?)\\$\\$O.*?_.*?_(.*?)\\d/);\n        if (idElement[2] == 'Marc'){\n          ids_notice.push('ie=' + idElement[1]);\n        }\n      }\n      else{\n        ids_notice.push('ie=' + almaIdList[i]);\n      }\n    }\n    this.openUrl = \"https://pudb-\" + instanceAlma\n                   + \".userservices.exlibrisgroup.com/view/uresolver/\"\n                   + institution \n                   + \"/openurl?ctx_enc=info:ofi/enc:UTF-8&ctx_id=10_1&ctx_tim=\" \n                   + ctxTim \n                   + \"&ctx_ver=Z39.88-2004&url_ctx_fmt=info:ofi/fmt:kev:mtx:ctx&url_ver=Z39.88-2004&rfr_id=info:sid/primo.exlibrisgroup.com-33PUDB_Alma_Marc&req_id=&rft_dat=\" \n                   + ids_notice.toString() \n                   + \",language=\" \n                   + langue\n                   + \",view=\" \n                   + this.REBUB_vue\n                   + \"&svc_dat=viewit&u.ignore_date_coverage=true&is_new_ui=true&Force_direct=false&req.skin=\" \n                   + skin;\n    /*Masquage/Affichage  de l'iframe*/\n    /******************************** */\n    for (var i in this.isShowContent) {\n      // console.log(i);\n      if(i != institution){\n        this.isShowContent[i] = false;  \n      }\n    }\n    this.isShowContent[institution] = !this.isShowContent[institution];\n    this.templateURL = 'custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/bouttonAfficheDispoElec.html';\n    // console.log(this.isShowContent);\n\n  }\n  trustAsUrl(url){\n    return this.sce.trustAsResourceUrl(url);\n  }\n}\n\ndispoElecAutresInstController.$inject = ['$sce'];\n\nexport let dispoElecAutresInstConfig = {\n  bindings: { parentCtrl: '<' },\n  controller: dispoElecAutresInstController,\n  template: dispoElecAutresInstHTML\n}","\nclass customGalleryDisplayController {\n    constructor($element){\n      setTimeout (()=>{\n        this.$element = $element;\n        // this.$document = $document;\n         console.log('---->33PUDB customGalleryDisplayController');\n         console.log(this);\n         var firstLine = this.parentCtrl.item.pnx.display.lds02 === undefined ? \"\" : this.parentCtrl.item.pnx.display.lds02;\n         var secondLine = this.parentCtrl.item.pnx.display.lds01 === undefined ? \"\" : this.parentCtrl.item.pnx.display.lds01;\n         console.log(this.$element[0].parentElement);\n         var conteneur = this.$element[0].parentElement.querySelector('div.item-info');\n         var infoExElement = document.createElement('div');\n         infoExElement.setAttribute('class','infoEx')\n         var firstLineElement = document.createElement('p');\n         firstLineElement.setAttribute('class','firstLine');\n         firstLineElement.innerText = firstLine;\n         infoExElement.appendChild(firstLineElement);\n         var secondLineElement = document.createElement('p');\n         secondLineElement.setAttribute('class','secondLine');\n         secondLineElement.innerText = secondLine;\n         infoExElement.appendChild(secondLineElement);\n         conteneur.appendChild(infoExElement);\n      }, 1000);\n    }\n  }\n\n  customGalleryDisplayController.$inject = ['$element'];\n  \n  export let customGalleryDisplayConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: customGalleryDisplayController,\n  }","class itemInLoanController {\n    constructor($element, $translate) {\n        this.$translate = $translate;\n        console.log(\"--->itemInLoanController\");\n        console.log(this);\n        var loanDate = this.parentCtrl.item.loandate;\n        var dueDate = this.parentCtrl.item.duedate;\n        var today = new Date();\n        var loanDuration = calcDiffDate(formatDate(dueDate), formatDate(loanDate));\n        var daysSinceLoanDate = calcDiffDate(today, formatDate(loanDate));\n        var institution = this.parentCtrl.item.ilsinstitutioncode;\n        console.log(institution);\n        if (institution != '33PUDB_UB'){\n            this.$translate('nui.loans.' + institution + '_duree_prolongation').then((duree_prolongation) => {\n                console.log(\"Durée de prolongation : \" + duree_prolongation);\n                // Si la durée du prêt est supérieure à la durée de la prolongation et si le nombre de jour écoulé depuis la date d'emprunt est inférieure à la durée de la prolongation\n                // Alors on bloque le prêt jusqu'à ce que le nombre de jours d'emprunt écoulés soit égal au nombre de jours de prolongation\n                // duree_prolongation = 14\n                if (loanDuration > duree_prolongation && this.parentCtrl.item.renew === \"Y\" && daysSinceLoanDate < duree_prolongation) {\n                    this.parentCtrl.item.renew = \"N\";\n                    $element.parent().children()[0].children[4].innerHTML = newButtonMsg(addDays(formatDate(loanDate), duree_prolongation), this.parentCtrl.loansService.requestParams.lang);\n                }\n                // Si la durée du prêt est inférieure à la durée de la prolongation alors on permet la prolongation 2 jours avant la date d'échéance du prêt.\n                else if (loanDuration <= duree_prolongation && this.parentCtrl.item.renew === \"Y\") {\n                    this.parentCtrl.item.renew = \"N\";\n                    $element.parent().children()[0].children[4].innerHTML = newButtonMsg(addDays(formatDate(dueDate), -2), this.parentCtrl.loansService.requestParams.lang);\n                }\n\n            });\n            console.log(\"Exemplaire emprunté le \" + loanDate + \". A rendre le \" + dueDate + \".\");\n            console.log(\"Exemplaire emprunté le \" + formatDate(loanDate) + \". A rendre le \" + formatDate(dueDate) + \".\");\n            console.log(\"Durée du prêt :\" + loanDuration);\n            // Si la durée du prêt est supérieure à 7 jours\n        }\n\n        // On vide l'affichage détaillé et on ne conserve que la dated'emprunt \n        this.parentCtrl.item._fullDisplayValues = [{ key: \"loan_date\", value: this.parentCtrl.item.loandate },\n        { key: \"max_renew_date\", value: this.parentCtrl.item.maxrenewdate }];\n\n\n\n\n        function formatDate(date) {\n            var regex = /(\\d{2})\\/(\\d{2})\\/(\\d{4})/;\n            var [, day, month, year] = regex.exec(date)\n            var formatedDate = new Date(year, month -1, day);\n            console.log(formatedDate);\n            return formatedDate;\n        }\n        function calcDiffDate(firstDate, secondDate) {\n            var oneDay = 24 * 60 * 60 * 1000; // hours*minutes*seconds*milliseconds    \n            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime()) / (oneDay)));\n            // console.log(diffDays);\n            return diffDays\n        }\n        function addDays(date, days) {\n            var result = new Date(date.getFullYear(),\n                date.getMonth(),\n                date.getDate() + days,\n                date.getHours(),\n                date.getMinutes(),\n                date.getSeconds(),\n                date.getMilliseconds()\n            );\n            // console.log(\"Result : \" + result.toLocaleDateString());\n            return result.toLocaleDateString();\n        }\n        function newButtonMsg(renewdateok, lang = 'fr_FR') {\n            var msg = {\n                \"fr_FR\": \"Prolongation impossible avant le \",\n                \"en_US\": \"Not renewable before \",\n                \"es_ES\": \"No renovable hasta \"\n            };\n            var fullMsg = msg[lang] + renewdateok;\n            var html = '<div class=\"not-renewable weak-text layout-align-start-center\" aria-label=\"' + fullMsg;\n            html = html + ' aria-hidden=\"false\" layout-align=\"start center\"><prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"lock\"><!----><md-icon ng-if=\"!$ctrl.isCustom\" md-svg-icon=\"primo-ui:lock\" alt=\"\" class=\"md-primoExplore-theme\" aria-hidden=\"true\"><svg id=\"lock\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"1320\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"><path d=\"M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z\"></path>   </svg></md-icon><!----><!----><prm-icon-after parent-ctrl=\"$ctrl\"></prm-icon-after></prm-icon><span>';\n            html = html + fullMsg + '</span><!----></div><!---->';\n            return html;\n        }\n    }\n\n}\nitemInLoanController.$inject = ['$element', '$translate'];\nexport let itemInLoanConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: itemInLoanController\n}","import authentificationForm from './authentificationAutresInst.html'\n\nclass authentificationAutresInstController {\n    constructor() {\n        //Debug\n        // console.log('---->33PUDB authentificationAutresInstController');\n        //DEBUG\n        // console.log(this);\n        //On recupere le host\n        this.hostAuth = this.parentCtrl.$location.$$host;\n        // console.log(\"hostAuth:\" + this.hostAuth);\n        //On récupère l'URL de départ :\n        //[AFA Patch 20/02/2019 : https://trello.com/c/Vsm7VgdA ] On teste le chemin car quand on arrive de l'extérieur et que la page ciblée demande une authentification fournie $$absurl est l'url de l'écran de login. Pour l'instant les seuls liens externes de cetypes pointent vers le compte lecteur. Donc si $$absUrl pointe vers l'écran de login on redirge vers  \n        if (this.parentCtrl.$location.$$path == \"/login\") {\n            this.absUrl = 'https://' + this.hostAuth + '/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n            //URL pour le travail en localhost\n            // this.absUrl = 'https://babordplus.hosted.exlibrisgroup.com/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n        }\n        else {\n            this.absUrl = this.parentCtrl.$location.$$absUrl;\n        }\n        //On encode correctement l'URL targeturl \n        this.absUrl = encodeURIComponent(this.absUrl);\n        // console.log(\"absUrl:\" + this.absUrl);\n        //On recupere le code vue source\n        this.sourceView = this.parentCtrl.$location.$$search.vid;\n        // console.log(\"sourceView:\" + this.sourceView);\n        //On récupére la langue de la session\n        this.langue = this.parentCtrl.$stateParams.lang;\n        //On contruit le debut de l'url pour l authentification\n        this.auth_base_url_const = 'https://' + this.hostAuth + '/primo_library/libweb/primoExploreLogin?institution=';\n        //URL Pour tester en local\n        // this.auth_base_url_const = 'https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/primoExploreLogin?institution=' ;\n        //Parcours d'une liste asso pour afficher auth IdP supplementaires\n        this.PUDB_Auth_Lists =  [\n                                    [\"1\", \"33PUDB_BXSA\", \"33PUDB_BXSA_SAML_BXSA\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_BXSA_VU1\"), \"33PUDB_BXSA_VU1\", \"Bordeaux Sciences Agro\"], \n                                    [\"2\", \"33PUDB_IEP\", \"33PUDB_IEP_SAML_IEP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_IEP_VU1\"), \"33PUDB_IEP_VU1\", \"Bordeaux Sciences Po\"],\n                                    [\"3\", \"33PUDB_UB\", \"33PUDB_UB_SAML_UB\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UB_VU1\"), \"33PUDB_UB_VU1\", \"Université de Bordeaux\"],\n                                    [\"4\", \"33PUDB_UBM\", \"33PUDB_UBM_SAML_UBM\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UBM_VU1\"), \"33PUDB_UBM_VU1\", \"Université Bordeaux Montaigne\"], \n                                    [\"5\", \"33PUDB_INP\", \"33PUDB_INP_SAML_INP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_INP_VU1\"), \"33PUDB_INP_VU1\", \"Bordeaux INP\"]];\n    }\n\n    setIdPShow(institution) {\n        //Le lien n'est pas proposé pour l'inst\n        // console.log(institution);\n        return Boolean(this.parentCtrl.usernamePasswordLoginService.inst !== institution);\n\n    }\n}\n\nexport let authentificationAutresInstConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: authentificationAutresInstController,\n    template: authentificationForm\n}","\nimport affDispo from './affDispo.html'\n//http://localhost:8003/primo-explore/search?query=any,contains,33PUDB_Alma_Unimarc7156806840004671%20OR%2033PUDB_Alma_Unimarc7180719980004671&tab=default_tab&search_scope=catalog_pci&vid=33PUDB_UBM_VU1&lang=en_US&offset=0\n//Cf. case Exlib # 00641786\n//Remonte la deuxième mention de disponibilté qui est parfois non affichée quand notices imprimés et électroniques ont été fusionnées \nclass affDispoController {\n  constructor($scope, $http, $element, $templateCache){\n    console.log('---->affDispoController');\n    if (this.parentCtrl.result.pnx.control.recordid[0].startsWith('dedup')){\n      // console.log(this.parentCtrl.result.pnx.display.title);\n      // console.log(this.parentCtrl.result.delivery);\n      if (this.parentCtrl.result.delivery.deliveryCategory.length == 1){\n        if (typeof this.parentCtrl.result.delivery.GetIt2 !== 'undefined') {\n          console.log('---->affDispoController : recalcule de la disponibilité');\n          var availability = getAvailabilityStatus(this.parentCtrl.result.delivery.holding);\n          this.locations = [];\n          this.locations.push({\n            availability: availability,\n            deliveryCode: 'delivery.code.'+ availability,\n            // toTranslate: productionVID(window.appConfig.vid),\n            useLinkIcon: true,\n            // outboundLink: illLink(pnx),\n          })\n      }\n      console.log(this.locations);\n      }\n    }\n    function getAvailabilityStatus(holding){\n      console.log(holding);\n      if (typeof holding == 'undefined' || holding == null) {\n        return \"unavailable_in_all_institutions\";\n      }\n      var availabilityStatus = [];\n      for (var i = 0; i < holding.length; i++) {\n        if (holding[i].isValidUser){\n          availabilityStatus.push(holding[i].availabilityStatus);  \n        }\n      }\n      if (availabilityStatus.length == 0){\n          return \"does_not_exist_in_maininstitution\";\n      }\n      else{\n        if (availabilityStatus.includes('available')){\n          return \"available_in_maininstitution\";\n        }\n        else {\n          return \"check_holdings\";\n        }\n      }\n    }\n    console.log(this);\n  }\n}\naffDispoController.$inject = ['$scope', '$http', '$element', '$templateCache' ]\nexport let affDispoConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: affDispoController,\n  template: affDispo\n}\n","class panierController {\n    constructor($http,$element) {\n      this.$http = $http;\n      this.element = $element;\n\n      console.log(\"Panier\");\n      console.log(this);\n      let view = this.parentCtrl.view;\n      this.institution = view.replace(/^33PUDB_(.*?)_.*/, '$1');\n      this.uSMS = this.parentCtrl.userSessionManagerService;\n      this.panierUser = \"\";\n      console.log(this.uSMS.isGuest());\n      if (this.uSMS) {\n        let jwtData = this.uSMS.jwtUtilService.getDecodedToken() || {};\n        console.log(jwtData);\n        this.panierUser = jwtData.user;\n\n      }\n      this.panierUrl = \"https://scoop.u-bordeaux.fr/panier/\" +  this.panierUser +\"/\" + this.institution\n      // this.nb_resa =  0;\n      // this.$http.get(\"/primo_library/libweb/webservices/rest/v1/myaccount/requests\")\n      //     .then(function mySuccess(response) {\n      //         console.log(response);\n      //         if (response.data.data != undefined) {\n      //             let resas = response.data;\n      //             console.log(\"Papayou\")\n      //             console.log(resas.status)\n      //             console.log(response);\n      //             if (resas.status == 'ok') {\n      //               this.nb_resa = resas.holds.hold.length\n      //             }\n      //             else{\n      //               console.log(\"Erreur\");\n      //               this.nb_resa =  0;\n      //             }\n                  \n      //             }\n      //         else{\n      //           console.log(\"Erreur\");\n      //           this.nb_resa =  0;\n      //         }\n      //     }, function myError(response) {\n      //         console.log(\"Erreur\");\n      //         this.nb_resa =  0;\n              \n      //     });\n\n      //     console.log(\"tuc\"); \n      //     console.log(this.nb_resa); \n\n\n    }\n\n\n  \n \n  };\n\n\n  panierController.$inject = ['$http','$element'];\n  export let panierConfig = {\n      bindings: {parentCtrl:'<'},\n      controller: panierController,\n      template: `\n        <div ng-if=\"$ctrl.uSMS.isGuest() == false && $ctrl.institution == 'UB'\" id=\"panier-covid\" class=\"layout-align-center layout-row\">\n          <a class=\"md-icon-button button-over-dark md-button md-primoExplore-theme md-ink-ripple\"\n                    aria-label=\"Votre Panier\" ng-click=\"$ctrl.openHelpMenu($event)\"\n                    href=\"{{$ctrl.panierUrl}}\" target=\"_blank\" title=\"accèder à vos documents réservés pour finaliser la commande\">\n            <prm-icon icon-type=\"svg\" svg-icon-set=\"action\" icon-definition=\"ic_shopping_basket_24px\"></prm-icon>\n          </a>\n        </div>`,\n    }\n    "],"sourceRoot":"/source/"}