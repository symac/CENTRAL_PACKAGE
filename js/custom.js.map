{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/CENTRAL_PACKAGE/js/main.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmBriefResultAfter/customBriefDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFacetExactAfter/customTLevelFacette.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/dispoElecAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoanAfter/itemInLoan.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoginAfter/authentificationAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchResultAvailabilityLineAfter/affDispo.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_customTLevelFacette","_authentificationAutresInst","_customBriefDisplay","_affDispo","_dispoElecAutresInst","_itemInLoan","app","angular","component","tLevelFacetteConfig","authentificationAutresInstConfig","customBriefDisplayConfig","affDispoConfig","dispoElecAutresInstConfig","itemInLoanConfig","bindings","parentCtrl","controller","customBriefDisplayController","_classCallCheck","this","console","log","item","context","firstLinetext","otherLines","pnx","display","title","auteur","creator","editeur","publisher","source","pubDate","creationdate","ispartof","adresse","hSecondLine","values","clazz","codes","key","text","delimiter","unshift","hFirstLine","control","recordid","startsWith","bibAddr","replace","tLevelFacetteController","facetGroup","name","tlevelFacetsValues","facetName","value","includes","splice","dispoElecAutresInstController","$sce","sce","service","serviceName","scrollId","linkElement","category","REBUB_vue","configurationUtil","vid","REBUB_institution","match","institutionsLIst","dispos","delivery","delcategory","isShowContent","dispoElement","push","dispo_autres_inst","institution","instanceAlma","toLowerCase","skin","langue","lang3","ctxTim","Date","toISOString","almaIdList","almaid","isDedup","ids_notice","idElement","openUrl","toString","templateURL","url","trustAsResourceUrl","$inject","template","itemInLoanController","$document","isRenewable","date","days","result","loanDate","loandate","dueDate","duedate","today","loanDuration","calcDiffDate","formatDate","daysSinceLoanDate","renew","renewdateok","setDate","getDate","toLocaleDateString","renewstatuses","renewmsg","renewstatus","_regex$exec","exec","_regex$exec2","_slicedToArray","day","month","year","formatedDate","firstDate","secondDate","diffDays","Math","round","abs","getTime","_fullDisplayValues","maxrenewdate","authentificationAutresInstController","hostAuth","$location","$$host","$$path","absUrl","$$absUrl","encodeURIComponent","sourceView","$$search","$stateParams","lang","auth_base_url_const","PUDB_Auth_Lists","Boolean","usernamePasswordLoginService","inst","affDispoController","$scope","$http","$element","$templateCache","deliveryCategory","GetIt2","availability","holding","availabilityStatus","isValidUser","getAvailabilityStatus","locations","deliveryCode","useLinkIcon"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {tLevelFacetteConfig} from './prmFacetExactAfter/customTLevelFacette'\nimport {authentificationAutresInstConfig} from './prmLoginAfter/authentificationAutresInst'\nimport {customBriefDisplayConfig} from './prmBriefResultAfter/customBriefDisplay'\nimport {affDispoConfig} from './prmSearchResultAvailabilityLineAfter/affDispo'\nimport {dispoElecAutresInstConfig} from './prmFullViewServiceContainerAfter/dispoElecAutresInst'\nimport {itemInLoanConfig} from './prmLoanAfter/itemInLoan'\n// import {bouttonAfficheDispoElecConfig} from './prmFullViewServiceContainerAfter/bouttonAfficheDispoElec'\n\nlet app = angular.module('centralCustom',[]);\nif (app){\n    app.component('prmFacetExactAfter', tLevelFacetteConfig);\n    app.component('prmLoginAfter', authentificationAutresInstConfig);\n    app.component('prmBriefResultAfter', customBriefDisplayConfig);\n    app.component('prmSearchResultAvailabilityLineAfter', affDispoConfig);\n    app.component('prmFullViewServiceContainerAfter', dispoElecAutresInstConfig);\n    app.component('prmLoanAfter',itemInLoanConfig);\n    // app.component('rebubComponent', bouttonAfficheDispoElecConfig);\n} \n\n// angular.module('primo-explore.config').run(['$templateCache', function($templateCache) {\n//     $templateCache.put('components/account/loans/loan.html','<h1>Yolo !!!</h1>');\n// }]);","class customBriefDisplayController {\n  constructor(){\n    console.log('---->33PUDB customBriefDisplayController');\n    // console.log(this);\n    /******************* */\n    /* Mise en forme PCI */\n    /******************* */\n    if (this.parentCtrl.item.context == \"PC\") {\n        var firstLinetext = this.parentCtrl.otherLines;\n        console.log(this.parentCtrl.item.pnx.display.title[0]);\n        /*Première ligne on envoie au composant les auteurs*/\n        var auteur = this.parentCtrl.item.pnx.display.creator;\n        var editeur = (typeof this.parentCtrl.item.pnx.display.publisher != \"undefined\") ? this.parentCtrl.item.pnx.display.publisher : this.parentCtrl.item.pnx.display.source;\n        var pubDate = this.parentCtrl.item.pnx.display.creationdate;\n        var ispartof = this.parentCtrl.item.pnx.display.ispartof;\n        console.log(ispartof);\n        /*Si 2e ligne + 3e ligne ispartog généré par PCI c'est le bordel.*/\n        /*TODO : à creuser*/\n        if (typeof ispartof == \"undefined\"){\n            var adresse = editeur + \" : \" + pubDate;\n            var hSecondValue = {\n                clazz : \"media-publisher\",\n                codes : [\"\"],\n                key : \"publisher\",\n                text : [adresse],\n                values : [adresse]\n            };\n            var hSecondLine = {\n                values : [hSecondValue],\n                delimiter : \" ;\"\n            };\n            firstLinetext.unshift(hSecondLine); \n        }\n        var hFirstValue = {\n            clazz : \"media-creator\",\n            codes : [\"\"],\n            key : \"creator\",\n            text : auteur,\n            values : auteur\n        };\n        var hFirstLine = {\n            values : [hFirstValue],\n            delimiter : \" ;\"\n        };\n        // console.log(firstLinetext);\n        firstLinetext.unshift(hFirstLine);\n        }\n        // console.log(this.parentCtrl.item.pnx.control.recordid[0]);\n        // console.log(this.parentCtrl.item.context);\n        \n        /****************************************************************************** */\n        /* Empêche l'affichage des deux champs lds01 dans le cas d'une notice fusionnée */\n        /****************************************************************************** */\n        if (this.parentCtrl.item.context == \"L\" && this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup')) {\n            var otherLines = this.parentCtrl.otherLines;\n            for (var i = 0; i < otherLines.length; i++) {\n                // console.log(otherLines[i].values[0].key);\n                if (otherLines[i].values[0].key == 'lds01'){\n                    var bibAddr = otherLines[i].values[0].text[0];\n                    // console.log(bibAddr);\n                    otherLines[i].values[0].text[0] = bibAddr.replace(/^(.*?)<br\\/>.*/, \"$1\");\n                }\n                \n            }\n        }\n    }\n//   get recordid() {\n//     return this.parentCtrl.item.pnx.control.recordid[0];\n//   }\n}\n\nexport let customBriefDisplayConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: customBriefDisplayController\n}","\n/*[33PUDB_NETWORK_AFA] - Customisation de la toplevel facette  */\n/*Suprime les entrées 'peer_reviewed','open_access'et'available'*/\nclass tLevelFacetteController {\n  constructor(){\n    console.log('----> 33PUDB tLevelFacetteController');\n    var facetType = this.parentCtrl.facetGroup.name; \n    /*Filtre sur la top level facette*/\n    if (facetType == \"tlevel\"){\n        /*Récupère les valeurs de la tlevel facette*/\n        var tlevelFacetsValues = this.parentCtrl.facetGroup.values;\n        // console.log(tlevelFacetsValues);\n        /*Parcours du tableau des valeurs*/\n        for (var i = 0; i < tlevelFacetsValues.length; i++) {\n            /*Récupère le nom de la facette*/\n            var facetName = tlevelFacetsValues[i].value;\n            // console.log(facetName);\n            /*On supprime les entrées relatives à la tlevel*/\n            if (['peer_reviewed', 'open_access', 'available'].includes(facetName)) {\n                tlevelFacetsValues.splice(i, 1);\n                i = i - 1;\n                // console.log(\"Supprimée\");\n            }\n        }\n    }\n  }\n\n  get recordid() {\n    return this.parentCtrl.item.pnx.control.recordid[0];\n  }\n}\n\nexport let tLevelFacetteConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: tLevelFacetteController,\n}\n","/*[33PUDB_NETWORK_AFA] - Affiche la disponibilité des RE dans une autre institution*/\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Marc7167182610004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20de%20droit&offset=0\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Unimarc7157521910004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20fran%C3%A7aise%20de%20gestion\nimport dispoElecAutresInstHTML from './dispoElecAutresInst.html'\n\nclass dispoElecAutresInstController {\n  constructor($sce) {\n    console.log(this);\n    this.sce = $sce;\n    /* Parfois les services ne sont pas passés au controleur parent...*/\n    if (typeof this.parentCtrl.service !== 'undefined'){\n      this.serviceName = this.parentCtrl.service.scrollId;\n      /*On ne travaille qu'au niveau du view it*/\n      if (this.serviceName == \"getit_link1_0\" && this.parentCtrl.service.linkElement.category == \"Alma-E\") {\n        console.log('---->dispoElecAutresInstController');\n        //Vue actuelle\n        this.REBUB_vue = this.parentCtrl.configurationUtil.vid;\n        //Je récupère le code de l'institution\n        this.REBUB_institution = this.parentCtrl.configurationUtil.vid.match(/(33PUDB_\\S+?)_/)[1];\n        this.institutionsLIst = [];\n        this.dispos = this.parentCtrl.item.pnx.delivery.delcategory;\n        this.isShowContent = {};\n        console.log(this);\n        //Je construit une liste avec chaque institution proposant l'accès électronique au documment (pnx/delivery/delcategory)\n        for (var i = 0; i < this.dispos.length; i++) {\n          var dispoElement = this.dispos[i].match(/(\\$\\$V|^)(.*?)\\$\\$I(.*?)(\\$|$)/);\n          if (dispoElement[2] == \"Alma-E\" && dispoElement[3] != this.REBUB_institution && dispoElement[3] != \"33PUDB_NETWORK\") {\n            this.institutionsLIst.push(dispoElement[3]);\n            this.isShowContent[dispoElement[3]] = false;\n          }\n        }\n        this.dispo_autres_inst = this.institutionsLIst.length > 0 ? true : false;\n        // console.log(this.institutionsLIst);\n      }\n    }\n  }\n\n  showComponent(institution) {\n\n    /*Construction de l'Open Url*/\n    /************************** */\n    var instanceAlma = institution.match(/33PUDB_(.*)/)[1].toLowerCase();\n    var skin = institution + '_VU1';\n    var langue = this.parentCtrl.item.lang3 ? this.parentCtrl.item.lang3 : \"fre\";\n    var date = new Date();\n    var ctxTim = date.toISOString();\n    /*On récupère l'identifiant des notices Alma*/\n    var almaIdList = this.parentCtrl.item.pnx.control.almaid;\n    var isDedup = this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup');\n    var ids_notice = [];\n    for (var i = 0; i < almaIdList.length; i++) {\n      /*Si la notice est fusionnée, les idAlma sont affichés comme ça : $$V33PUDB_NETWORK:7167176110004671$$O33PUDB_Alma_Marc7167176110004671\n      On extrait l'identifiant et on filtre les notices électroniques (Alma_Marc)*/\n      if (isDedup){\n        var idElement = almaIdList[i].match(/\\$\\$V(.*?)\\$\\$O.*?_.*?_(.*?)\\d/);\n        if (idElement[2] == 'Marc'){\n          ids_notice.push('ie=' + idElement[1]);\n        }\n      }\n      else{\n        ids_notice.push('ie=' + almaIdList[i]);\n      }\n    }\n    this.openUrl = \"https://pudb-\" + instanceAlma\n                   + \".userservices.exlibrisgroup.com/view/uresolver/\"\n                   + institution \n                   + \"/openurl?ctx_enc=info:ofi/enc:UTF-8&ctx_id=10_1&ctx_tim=\" \n                   + ctxTim \n                   + \"&ctx_ver=Z39.88-2004&url_ctx_fmt=info:ofi/fmt:kev:mtx:ctx&url_ver=Z39.88-2004&rfr_id=info:sid/primo.exlibrisgroup.com-33PUDB_Alma_Marc&req_id=&rft_dat=\" \n                   + ids_notice.toString() \n                   + \",language=\" \n                   + langue\n                   + \",view=\" \n                   + this.REBUB_vue\n                   + \"&svc_dat=viewit&u.ignore_date_coverage=true&is_new_ui=true&Force_direct=false&req.skin=\" \n                   + skin;\n    /*Masquage/Affichage  de l'iframe*/\n    /******************************** */\n    for (var i in this.isShowContent) {\n      console.log(i);\n      if(i != institution){\n        this.isShowContent[i] = false;  \n      }\n    }\n    this.isShowContent[institution] = !this.isShowContent[institution];\n    this.templateURL = 'custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/bouttonAfficheDispoElec.html';\n    console.log(this.isShowContent);\n\n  }\n  trustAsUrl(url){\n    return this.sce.trustAsResourceUrl(url);\n  }\n}\n\ndispoElecAutresInstController.$inject = ['$sce'];\n\nexport let dispoElecAutresInstConfig = {\n  bindings: { parentCtrl: '<' },\n  controller: dispoElecAutresInstController,\n  template: dispoElecAutresInstHTML\n}","class itemInLoanController { \n    constructor($document){\n        console.log(\"--->itemInLoanController\");\n        console.log(this);\n        console.log($document);\n        console.log(this.parentCtrl.isRenewable);\n        var loanDate = this.parentCtrl.item.loandate;\n        var dueDate = this.parentCtrl.item.duedate;\n        var today = new Date();\n        var loanDuration = calcDiffDate(formatDate(dueDate), formatDate(loanDate))\n        var daysSinceLoanDate = calcDiffDate(today, formatDate(loanDate));\n        console.log(\"Exemplaire emprunté le \"+loanDate +\". A rendre le \"+dueDate+\".\");\n        console.log(\"Durée du prêt :\"+loanDuration);\n\n        // Si la durée du prêt est supérieure à 7 jours\n        if (loanDuration > 7 && this.parentCtrl.item.renew === \"Y\"){\n            if( daysSinceLoanDate < 7) {\n                this.parentCtrl.item.renew = \"N\";\n                this.parentCtrl.item.renewdateok = addDays(today,daysSinceLoanDate);\n                this.parentCtrl.item.renewstatuses = {};\n                var renewmsg = \"Cet exemplaire pourra être renouvelé à partir du \"+this.parentCtrl.item.renewdateok;\n                this.parentCtrl.item.renewstatuses.renewstatus = [renewmsg];\n            } \n        }\n        // this.parentCtrl.item._fullDisplayValues.splice(5,5);\n        // this.parentCtrl.item._fullDisplayValues.splice(0,4);\n\n        this.parentCtrl.item._fullDisplayValues = [ {key : \"loan_date\", value : this.parentCtrl.item.loandate},\n                                                    {key : \"max_renew_date\", value : this.parentCtrl.item.maxrenewdate}];\n\n\n    \n        \n        function formatDate(date){\n            var regex = /(\\d{2})\\/(\\d{2})\\/(\\d{4})/;\n            var [,day, month, year] = regex.exec(date)\n            var formatedDate = new Date(year, month - 1 , day);\n            console.log(formatedDate);\n            return formatedDate;\n        }\n        function calcDiffDate(firstDate, secondDate){\n            var oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds    \n            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime())/(oneDay)));\n            console.log(diffDays);\n            return diffDays\n        }\n        function addDays(date,days){\n            var result = new Date();\n            console.log(date+\" + \"+days);\n            result.setDate(date.getDate() + (7-days));\n            return result.toLocaleDateString();\n        }\n    }\n\n}\nitemInLoanController.$inject = ['$document'];\nexport let itemInLoanConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: itemInLoanController,\n    // template: authentificationForm\n}","import authentificationForm from './authentificationAutresInst.html'\n\nclass authentificationAutresInstController {\n    constructor() {\n        //Debug\n        console.log('---->33PUDB authentificationAutresInstController');\n        //DEBUG\n        // console.log(this);\n        //On recupere le host\n        this.hostAuth = this.parentCtrl.$location.$$host;\n        // console.log(\"hostAuth:\" + this.hostAuth);\n        //On récupère l'URL de départ :\n        //[AFA Patch 20/02/2019 : https://trello.com/c/Vsm7VgdA ] On teste le chemin car quand on arrive de l'extérieur et que la page ciblée demande une authentification fournie $$absurl est l'url de l'écran de login. Pour l'instant les seuls liens externes de cetypes pointent vers le compte lecteur. Donc si $$absUrl pointe vers l'écran de login on redirge vers  \n        if (this.parentCtrl.$location.$$path == \"/login\") {\n            this.absUrl = 'https://' + this.hostAuth + '/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n            //URL pour le travail en localhost\n            // this.absUrl = 'https://babordplus.hosted.exlibrisgroup.com/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n        }\n        else {\n            this.absUrl = this.parentCtrl.$location.$$absUrl;\n        }\n        //On encode correctement l'URL targeturl \n        this.absUrl = encodeURIComponent(this.absUrl);\n        // console.log(\"absUrl:\" + this.absUrl);\n        //On recupere le code vue source\n        this.sourceView = this.parentCtrl.$location.$$search.vid;\n        // console.log(\"sourceView:\" + this.sourceView);\n        //On récupére la langue de la session\n        this.langue = this.parentCtrl.$stateParams.lang;\n        //On contruit le debut de l'url pour l authentification\n        this.auth_base_url_const = 'https://' + this.hostAuth + '/primo_library/libweb/primoExploreLogin?institution=';\n        //URL Pour tester en local\n        // this.auth_base_url_const = 'https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/primoExploreLogin?institution=' ;\n        //Parcours d'une liste asso pour afficher auth IdP supplementaires\n        this.PUDB_Auth_Lists =  [\n                                    [\"1\", \"33PUDB_BXSA\", \"33PUDB_BXSA_SAML_BXSA\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_BXSA_VU1\"), \"33PUDB_BXSA_VU1\", \"Bordeaux Sciences Agro\"], \n                                    [\"2\", \"33PUDB_IEP\", \"33PUDB_IEP_SAML_IEP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_IEP_VU1\"), \"33PUDB_IEP_VU1\", \"Bordeaux Sciences Po\"],\n                                    [\"3\", \"33PUDB_UB\", \"33PUDB_UB_SAML_UB\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UB_VU1\"), \"33PUDB_UB_VU1\", \"Université de Bordeaux\"],\n                                    [\"4\", \"33PUDB_UBM\", \"33PUDB_UBM_SAML_UBM\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UBM_VU1\"), \"33PUDB_UBM_VU1\", \"Université Bordeaux Montaigne\"], \n                                    [\"5\", \"33PUDB_INP\", \"33PUDB_INP_SAML_INP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_INP_VU1\"), \"33PUDB_INP_VU1\", \"Bordeaux INP\"]];\n    }\n\n    setIdPShow(institution) {\n        //Le lien n'est pas proposé pour l'inst\n        // console.log(institution);\n        return Boolean(this.parentCtrl.usernamePasswordLoginService.inst !== institution);\n\n    }\n}\n\nexport let authentificationAutresInstConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: authentificationAutresInstController,\n    template: authentificationForm\n}","\nimport affDispo from './affDispo.html'\n//http://localhost:8003/primo-explore/search?query=any,contains,33PUDB_Alma_Unimarc7156806840004671%20OR%2033PUDB_Alma_Unimarc7180719980004671&tab=default_tab&search_scope=catalog_pci&vid=33PUDB_UBM_VU1&lang=en_US&offset=0\n//Cf. case Exlib # 00641786\n//Remonte la deuxième mention de disponibilté qui est parfois non affichée quand notices imprimés et électroniques ont été fusionnées \nclass affDispoController {\n  constructor($scope, $http, $element, $templateCache){\n    console.log('---->affDispoController');\n    if (this.parentCtrl.result.pnx.control.recordid[0].startsWith('dedup')){\n      // console.log(this.parentCtrl.result.pnx.display.title);\n      // console.log(this.parentCtrl.result.delivery);\n      if (this.parentCtrl.result.delivery.deliveryCategory.length == 1){\n        if (typeof this.parentCtrl.result.delivery.GetIt2 !== 'undefined') {\n          console.log('---->affDispoController : recalcule de la disponibilité');\n          var availability = getAvailabilityStatus(this.parentCtrl.result.delivery.holding);\n          this.locations = [];\n          this.locations.push({\n            availability: availability,\n            deliveryCode: 'delivery.code.'+ availability,\n            // toTranslate: productionVID(window.appConfig.vid),\n            useLinkIcon: true,\n            // outboundLink: illLink(pnx),\n          })\n      }\n      console.log(this.locations);\n      }\n    }\n    function getAvailabilityStatus(holding){\n      console.log(holding);\n      if (typeof holding == 'undefined' || holding == null) {\n        return \"unavailable_in_all_institutions\";\n      }\n      var availabilityStatus = [];\n      for (var i = 0; i < holding.length; i++) {\n        if (holding[i].isValidUser){\n          availabilityStatus.push(holding[i].availabilityStatus);  \n        }\n      }\n      if (availabilityStatus.length == 0){\n          return \"does_not_exist_in_maininstitution\";\n      }\n      else{\n        if (availabilityStatus.includes('available')){\n          return \"available_in_maininstitution\";\n        }\n        else {\n          return \"check_holdings\";\n        }\n      }\n    }\n    console.log(this);\n  }\n}\naffDispoController.$inject = ['$scope', '$http', '$element', '$templateCache' ]\nexport let affDispoConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: affDispoController,\n  template: affDispo\n}\n"],"sourceRoot":"/source/"}