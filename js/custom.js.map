{"version":3,"sources":["node_modules/browser-pack/_prelude.js","primo-explore/custom/CENTRAL_PACKAGE/js/main.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmAuthenticationAfter/forceAuth.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmBriefResultAfter/customBriefDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmCollectionNavigationBreadcrumbsAfter/changeLinkToCollectionDiscovery.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmExploreFooterAfter/logosInsts.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFacetExactAfter/customTLevelFacette.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/dispoElecAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmGalleryItemAfter/customGalleryDisplay.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoanAfter/itemInLoan.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmLoginAfter/authentificationAutresInst.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmSearchResultAvailabilityLineAfter/affDispo.js","primo-explore/custom/CENTRAL_PACKAGE/js/prmUserAreaExpandableAfter/panier.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","actions","_customTLevelFacette","_authentificationAutresInst","_customBriefDisplay","_customGalleryDisplay","_affDispo","_dispoElecAutresInst","_itemInLoan","_forceAuth","_logosInsts","_panier","_changeLinkToCollectionDiscovery","app","angular","getZoterobibq","addata","risformattype","linktopnx","isbn","doi","pmid","lad21","toString","replace","component","tLevelFacetteConfig","authentificationAutresInstConfig","customBriefDisplayConfig","customGalleryDisplayConfig","affDispoConfig","dispoElecAutresInstConfig","itemInLoanConfig","forceAuthConfig","logosInstsConfig","panierConfig","panierCompteLecteurConfig","changeLinkToCollectionDiscoveryConfig","name","type","icon","set","action","service","processCustomAction","prmActionCtrl","slug","iconname","toLowerCase","index","Object","keys","actionListService","actionsToIndex","this","push","setCustomAction","actionLabelNamesMap","actionIconNamesMap","actionIcons","iconSet","requiredActionsList","actionsToDisplay","unshift","actionurl","console","log","item","zoterobibq","url","URL","document","location","href","hostname","context","pnx","control","recordid","ristype","format","hasOwnProperty","templateVar","onToggle","window","open","setCustomActionContainer","mdTabsCtrl","getCustomActions","controller","$scope","customActionService","vm","$onInit","forEach","processedAction","bindings","parentCtrl","forceAuthController","_classCallCheck","key","queryStartPos","indexOf","params","substring","split","pairs","decodeURIComponent","shift","join","getQueryParam","loginService","$location","$$absUrl","target_url","encodeURIComponent","institution","authenticationService","userSessionManagerService","inst","authenticationProfile","auth_url","customBriefDisplayController","firstLinetext","auteur","display","creator","editeur","publisher","source","pubDate","creationdate","ispartof","adresse","hSecondLine","values","clazz","codes","text","delimiter","hFirstLine","otherLines","startsWith","lds02","lds01","changeLinkToCollectionDiscoveryController","$element","$translate","_this","view_institution","$stateParams","vid","substr","collection_institution","_breadcrumbStateParams","parent","children","setAttribute","collectionId","title","then","translation","innerText","$inject","logosInstsController","displayFooter","searchParams","get","pathname","view","myInstitution","institutionsList","institutionsUrl","mappingTablesCache","MAPPING_TABLES_CACHE","institutionObjet","source1","RegExp","message","sort","template","tLevelFacetteController","facetGroup","tlevelFacetsValues","facetName","value","includes","splice","dispoElecAutresInstController","$sce","sce","serviceName","scrollId","linkElement","category","REBUB_vue","configurationUtil","REBUB_institution","match","institutionsLIst","dispos","delivery","delcategory","isShowContent","dispoElement","dispo_autres_inst","instanceAlma","skin","langue","lang3","ctxTim","Date","toISOString","almaIdList","almaid","isDedup","ids_notice","idElement","openUrl","templateURL","trustAsResourceUrl","customGalleryDisplayController","setTimeout","firstLine","undefined","secondLine","parentElement","conteneur","querySelector","infoExElement","createElement","firstLineElement","appendChild","secondLineElement","itemInLoanController","loanDate","loandate","dueDate","duedate","today","loanDuration","calcDiffDate","formatDate","daysSinceLoanDate","ilsinstitutioncode","date","_regex$exec","exec","_regex$exec2","_slicedToArray","day","month","year","formatedDate","firstDate","secondDate","Math","round","abs","getTime","addDays","days","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","toLocaleDateString","newButtonMsg","renewdateok","fullMsg","fr_FR","en_US","es_ES","arguments","html","duree_prolongation","renew","innerHTML","loansService","requestParams","lang","_fullDisplayValues","maxrenewdate","authentificationAutresInstController","hostAuth","$$host","$$path","absUrl","sourceView","$$search","auth_base_url_const","PUDB_Auth_Lists","Boolean","usernamePasswordLoginService","affDispoController","$http","$templateCache","result","deliveryCategory","GetIt2","availability","holding","availabilityStatus","isValidUser","getAvailabilityStatus","locations","deliveryCode","useLinkIcon","showForInst","panierController","element","showLink","uSMS","panierUser","jwtData","jwtUtilService","getDecodedToken","user","panierUrl","panierCompteLecteurController","cetcinst","requestsCounter"],"mappings":"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","file":"custom.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import {tLevelFacetteConfig} from './prmFacetExactAfter/customTLevelFacette';\nimport {authentificationAutresInstConfig} from './prmLoginAfter/authentificationAutresInst';\nimport {customBriefDisplayConfig} from './prmBriefResultAfter/customBriefDisplay';\nimport {customGalleryDisplayConfig} from './prmGalleryItemAfter/customGalleryDisplay';\nimport {affDispoConfig} from './prmSearchResultAvailabilityLineAfter/affDispo';\nimport {dispoElecAutresInstConfig} from './prmFullViewServiceContainerAfter/dispoElecAutresInst';\nimport {itemInLoanConfig} from './prmLoanAfter/itemInLoan';\n// import {showAlertMessageConfig} from './prmSearchBarAfter/showAlertMessage'\n// import {getThumbnailConfig} from './prmSearchResultThumbnailContainerAfter/getThumbnail';\nimport {forceAuthConfig} from './prmAuthenticationAfter/forceAuth';\nimport {logosInstsConfig} from './prmExploreFooterAfter/logosInsts';\n// import {alertMessageConfig} from './prmBackToLibrarySearchButtonAfter/alertMessage';\nimport {panierConfig} from './prmUserAreaExpandableAfter/panier';\nimport {panierCompteLecteurConfig} from './prmUserAreaExpandableAfter/panier';\n// import { MessageService } from './prmTopbarAfter/message.service';\n// import { PrmTopbarAfterConfig } from './prmTopbarAfter/prmTopbarAfter.component';\nimport {changeLinkToCollectionDiscoveryConfig} from './prmCollectionNavigationBreadcrumbsAfter/changeLinkToCollectionDiscovery';\n\nlet app = angular.module('centralCustom',[]);\nif (app){\n    //Customisation de la Top Level facet\n    app.component('prmFacetExactAfter', tLevelFacetteConfig);\n    //Customisation de l'écran d'authentification. Redirection vers les Primo des établissements du réseau\n    app.component('prmLoginAfter', authentificationAutresInstConfig);\n    //Customisation de l'affichage des notices dan sla liste des résultats\n    app.component('prmBriefResultAfter', customBriefDisplayConfig);\n    //Customisation de l'affichage des le collection discovery : ajoute l'auteur et l'édieur sous la vignette du document.\n    app.component('prmGalleryItemAfter', customGalleryDisplayConfig);\n    //Remonte la deuxième mention de disponibilté qui est parfois non affichée quand notices imprimés et électroniques ont été fusionnées \n    app.component('prmSearchResultAvailabilityLineAfter', affDispoConfig);\n    //Affichage de la disponibilité des documents électroniques dans les autres institutions du réseau\n    app.component('prmFullViewServiceContainerAfter', dispoElecAutresInstConfig);\n    //Empêche la réservation si l'emprunt date d'il y a moins de 7 jours (durée maximale de prolongation dans le réseau) \n    //+ Supprime des informations inutiles dans la liste des exemplaires empruntés\n    app.component('prmLoanAfter',itemInLoanConfig);\n    //Permet de forcer l'authentification à a partir d'une authentification externe (bug ENT UB)\n    app.component('prmAuthenticationAfter',forceAuthConfig);\n    //Ajoute un pied de page avec les logos des autres institutions membres du réseau et le lien vers leurs catalogues\n    app.component('prmExploreFooterAfter',logosInstsConfig);\n    //Clique et collecte : Ajoute un bouton panier dans le menu principale pour les utilisateurs authentifiés\n    app.component('prmUserAreaExpandableAfter',panierConfig);\n    //Clique et collecte : Ajoute un  lien vers l'application de prise de rdv dans l'onglet réservation du compte lecteur\n    app.component('prmRequestsAfter',panierCompteLecteurConfig);\n    //Collection discovery : modifie les liens vers les sélections dans l'affichage détaillé pour afficher la sélection dans la vue de l'institution propriétaire\n    app.component('prmCollectionNavigationBreadcrumbsItemAfter',changeLinkToCollectionDiscoveryConfig);\n    \n    // app.component('prmBackToLibrarySearchButtonAfter',alertMessageConfig);\n    // app.service('messageService', MessageService);\n    // app.component(PrmTopbarAfterConfig.name, PrmTopbarAfterConfig.config);\n    // app.component('prmCollectionGalleryHeaderAfter',modifyCollectionTopTitleConfig)\n    // app.component('prmSearchBarAfter',showAlertMessageConfig);\n    // app.component('prmSearchResultThumbnailContainerAfter',getThumbnailConfig);\n} \n//Ajout d'un service permettant l'envoi des références vers ZoteroBib\n// START ------ Primo-ZoteroBib-Add-On ------/\nfunction insertActions(actions) {\n    app.service('customActionService', function() {\n        return {\n            actions: [],\n            processCustomAction: function(prmActionCtrl, action) {\n                action.slug = action.name.replace(/\\s+/g, ''); // remove whitespace\n                action.iconname = action.slug.toLowerCase();\n                action.index = Object.keys(prmActionCtrl.actionListService.actionsToIndex).length - 1 ; // ignore \"none\" and RISPushTo\n                this.actions.push(action);\n                return action;\n            },\n            setCustomAction: function(prmActionCtrl, action) {\n                    prmActionCtrl.actionLabelNamesMap[action.slug] = action.name;\n                    prmActionCtrl.actionIconNamesMap[action.slug] = action.iconname;\n                    prmActionCtrl.actionIcons[action.iconname] = {\n                        icon: action.icon.name,\n                        iconSet: action.icon.set,\n                        type: \"svg\"\n                    };\n                    if (!prmActionCtrl.actionListService.actionsToIndex[action.slug]) { // ensure we aren't duplicating the entry\n                        prmActionCtrl.actionListService.requiredActionsList[action.index] = action.slug;\n                        prmActionCtrl.actionListService.actionsToDisplay.unshift(action.slug);\n                        prmActionCtrl.actionListService.actionsToIndex[action.slug] = action.index;\n                    }\n                    \n                    var actionurl = \"\";\n                                                        \n                    if (action.type === 'urlredirectzotero') {\n                      console.log(prmActionCtrl.item);\n                        var zoterobibq = \"0\";\n                        //Construct link to PNX record\n                        var url = new URL(document.location.href);\n                        var hostname = url.hostname;\n                         console.log(url.hostname);\n                        var context = prmActionCtrl.item.context\n                        var recordid = prmActionCtrl.item.pnx.control.recordid;\n                        var linktopnx =\"https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/webservices/rest/primo-explore/v1/pnxs/xml/\"+context+\"/\"+recordid+\"?inst=33PUDB_NETWORK%26showPnx=true\";\n                        // var linktopnx =\"https://\"+url.hostname+\"/primo_library/libweb/webservices/rest/primo-explore/v1/pnxs/xml/\"+context+\"/\"+recordid+\"?inst=33PUDB_UB%26showPnx=true\";\n                          //check is RISTYPE Exists\n                          if (typeof prmActionCtrl.item.pnx.addata.ristype == 'undefined'){\n                            console.log(\"format\" + prmActionCtrl.item.pnx.addata.format);\n                            zoterobibq = linktopnx;\n                          }else{\n                            console.log(\"format\" + prmActionCtrl.item.pnx.addata.ristype.toString().toLowerCase())\n                            switch(prmActionCtrl.item.pnx.addata.ristype.toString().toLowerCase()) {\n                              case \"book\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 0,linktopnx);\n                                break;\n                              case \"jour\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 1,linktopnx);\n                                break;\n                              case \"gen\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 2,linktopnx);\n                                break;\n                              case \"thes\":\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 3, linktopnx);\n                                break;\n\n                              default:\n                                zoterobibq = getZoterobibq(prmActionCtrl.item.pnx.addata, 4, linktopnx);\n                            }\t\t\t\t\t\t\t\t\n                          }\t\t\t\t\t\t\t  \n                      if (action.hasOwnProperty('templateVar')) {\n                          action.action = action.action.replace(/{\\d}/g, function(r){return action.templateVar[r.replace(/[^\\d]/g,'')]});\n                          console.log(\"templateVar\");\n                      }\n                        actionurl = action.action + zoterobibq;\n                        console.log(actionurl);\n                    }\t\t\t\t\t\t\n                    prmActionCtrl.actionListService.onToggle[action.slug] = function(){\t\t\t\t\t\t\t\n                        window.open(actionurl, '_blank'); // opens the url in a new window\n                    };\n            },\n            setCustomActionContainer: function(mdTabsCtrl, action) { // for further review...\n            },\n            getCustomActions: function() {\n                return this.actions;\n            }\n        };\n    })\n    .component('prmActionListAfter', {\n        require: {\n            prmActionCtrl: '^prmActionList',\n        },\n        controller: 'customActionController'\n    })\n    .controller('customActionController', ['$scope', 'customActionService', function($scope, customActionService) {\n        var vm = this;\n        vm.$onInit = function() {\t\t\t\n            actions.forEach(function(action) {\n                var processedAction = customActionService.processCustomAction(vm.prmActionCtrl, action);\n                customActionService.setCustomAction(vm.prmActionCtrl, processedAction);\n                \n            });\n        };\n    }])\n}\n// END ------ Primo-VE-ZoteroBib-Add-On ------/\t\n\n\n//Replace name and icon with you own\ninsertActions([{\n    name: \"ZoteroBib\",\n    type: \"urlredirectzotero\",\n    icon: {\n        set: 'primo-actions',\n        name: 'easybib'\n    },\n    action: \"https://zbib.org/import?q=\"\n}]);\n\n\n//Place this function outside the main function\n//Function to get ISBN, DOI, PMID,arXiv ID, or title\nfunction getZoterobibq(addata, risformattype, linktopnx)\n{\n\tswitch(risformattype) {\n    case 0: // book\n    if (typeof addata.isbn !== 'undefined')\n        if(addata.isbn.length > 1)\n            return addata.isbn[0];\n        else\n            return addata.isbn;\n    return linktopnx;\n\t\tbreak;\n\t  case 1: //jour\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined')\n\t\t\treturn addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');\n    return linktopnx;\n        break;\n\t  case 2: //gen\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined')\n\t\t\treturn addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');\n    return linktopnx;\n        break;\n\t  case 3: //thesis\n\t\tif (typeof addata.doi !== 'undefined')\n\t\t\treturn addata.doi;\n\t\tif (typeof addata.pmid !== 'undefined')\n\t\t\treturn addata.pmid;\n\t\tif (typeof addata.lad21 !== 'undefined'){\n            return addata.lad21.toString().replace(/\\barXiv.org:\\b~?/g, '');}\n    return linktopnx;\n\t\tbreak;\n\t  default:// will use the title if no ISBN, DOI, PMID,arXiv ID\n\t\treturn linktopnx;\n\t}\n}","class forceAuthController {\n    constructor(){\n      // console.log('---->33PUDB forceauth');\n      // console.log(this);\n      // console.log(this.parentCtrl.authenticationMethods);\n      // console.log(this.parentCtrl.loginService.handleLogin());\n      var forceLogin = getQueryParam(this.parentCtrl.loginService.$location.$$absUrl, \"forcelogin\")\n      if (forceLogin == 'true'){\n        // console.log(\"redirection\");\n        let target_url = this.parentCtrl.loginService.$location.$$absUrl.replace('&forcelogin=true','')\n        target_url = encodeURIComponent(target_url);\n        let institution = this.parentCtrl.authenticationService.userSessionManagerService.inst;\n        let authenticationProfile = institution + \"_SAML_\" + institution.replace('33PUDB_','')\n        let auth_url = \"/primo_library/libweb/primoExploreLogin?institution=\"+institution+\"&lang=fr_FR&target-url=\"+target_url+\"&authenticationProfile=\"+authenticationProfile;\n        location.href = auth_url;\n      }\n      \n      // location.href = \"http://example.com\";\n      \n      function getQueryParam(url, key) {\n        var queryStartPos = url.indexOf('?');\n        if (queryStartPos === -1) {\n          return;\n        }\n        var params = url.substring(queryStartPos + 1).split('&');\n        for (var i = 0; i < params.length; i++) {\n          var pairs = params[i].split('=');\n          if (decodeURIComponent(pairs.shift()) == key) {\n            return decodeURIComponent(pairs.join('='));\n          }\n        }\n      }\n    }\n    \n  }\n  export let forceAuthConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: forceAuthController\n  }","class customBriefDisplayController {\n    constructor() {\n        console.log('---->33PUDB customBriefDisplayController');\n        console.log(this);\n        /***********************************/\n        /* Mise en forme des résultats CD */\n        /********************************* */\n        //Nous utilisons des champs locaux pour alimenter les 2ème & 3ème lignes du brief display. \n        //Les champs Auteurs publisher et partof (pour lesa rticles) utilisé initialement pour le brief display ne remontent plus pour PCI. \n        //Ce correctif permet de récupérer les champs Pnx et les afficher dans l'affichage abrégé.\n        /**************************************************************************************** */\n        //La notice vient de l'index central\n        if (this.parentCtrl.item.context == \"PC\") {\n            var firstLinetext = [];\n            var auteur = this.parentCtrl.item.pnx.display.creator;\n            var editeur = (typeof this.parentCtrl.item.pnx.display.publisher != \"undefined\") ? this.parentCtrl.item.pnx.display.publisher : this.parentCtrl.item.pnx.display.source;\n            var pubDate = this.parentCtrl.item.pnx.display.creationdate;\n            var ispartof = this.parentCtrl.item.pnx.display.ispartof;\n            var hSecondValue= {};\n            /*Seconde ligne on envoie au composant la zone de l'adresse biblio ou les ref. de la publication dont l'article est tiré*/\n            var adresse =  editeur + \" : \" + pubDate;\n            if (typeof ispartof === \"undefined\") {\n                hSecondValue = {\n                    clazz: \"media-publisher\",\n                    codes: [\"\"],\n                    key: \"publisher\",\n                    text: [adresse],\n                    values: [adresse]\n                };\n            }\n            else {\n                hSecondValue = {\n                    clazz: \"media-ispartof\",\n                    codes: [\"\"],\n                    key: \"ispartof\",\n                    text: ispartof,\n                    values: ispartof\n                };\n            }\n            var hSecondLine = {\n                values: [hSecondValue],\n                delimiter: \" ; \"\n            };\n            firstLinetext.unshift(hSecondLine);\n            /*Première ligne on envoie au composant les auteurs*/\n            var hFirstValue = {\n                clazz: \"media-creator\",\n                codes: [\"\"],\n                key: \"creator\",\n                text: auteur,\n                values: auteur\n            };\n            var hFirstLine = {\n                values: [hFirstValue],\n                delimiter: \" ; \"\n            };\n            // console.log(firstLinetext);\n            firstLinetext.unshift(hFirstLine);\n            this.parentCtrl.otherLines = firstLinetext;\n        }\n        console.log(this.parentCtrl.otherLines);\n        /****************************************************************************** */\n        /* Empêche l'affichage des deux champs lds01 dans le cas d'une notice fusionnée */\n        /****************************************************************************** */\n        /*Lorsqu'une notice est fusionnée Primo conserve tous les champs locaux. Ainsi le*/\n        /* champ lds01 que nous utilisons pour afficher l'adresse bibliographique de la  */\n        /*publication est doublé. Ce module ne conserve que le champ construit à partir  */\n        /*de la notice Unimarc.*/\n        //Test sur la notice fusionnée\n        if (this.parentCtrl.item.context == \"L\" && this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup')) {\n            console.log('dedup');\n            var firstLinetext = [];\n            var auteur = this.parentCtrl.item.pnx.display.lds02;\n            var adresse = this.parentCtrl.item.pnx.display.lds01[0];\n             /*Seconde ligne on envoie au composant la zone de l'adresse biblio*/\n            console.log(adresse);\n            var hSecondValue = {\n                clazz: \"media-publisher\",\n                codes: [\"\"],\n                key: \"publisher\",\n                text: [adresse],\n                values: [adresse]\n            };\n            var hSecondLine = {\n                values: [hSecondValue],\n                delimiter: \" ; \"\n            };\n            firstLinetext.unshift(hSecondLine);\n            /*Première ligne on envoie au composant les auteurs*/\n            var hFirstValue = {\n                clazz: \"media-creator\",\n                codes: [\"\"],\n                key: \"creator\",\n                text: auteur,\n                values: auteur\n            };\n            var hFirstLine = {\n                values: [hFirstValue],\n                delimiter: \" ; \"\n            };\n            firstLinetext.unshift(hFirstLine);\n            this.parentCtrl.otherLines = firstLinetext;\n        }\n\n\n    }\n}\n\nexport let customBriefDisplayConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: customBriefDisplayController\n}","class changeLinkToCollectionDiscoveryController {\n    // \n\n    constructor($element, $translate) {\n        this.$translate = $translate;\n        this.$element = $element;\n\n\n        var view_institution = this.parentCtrl.$stateParams.vid.substr(0, this.parentCtrl.$stateParams.vid.length - 4 );\n        var collection_institution = this.parentCtrl._breadcrumbStateParams.inst ? this.parentCtrl._breadcrumbStateParams.inst : view_institution;\n        console.log(view_institution + \"/\" + collection_institution);\n        console.log(this)\n        console.log( this.$element.parent().children()[0]);\n        //Si l'institution de la vue n'est pas la même que celle de la collection on modifie la vue dans le lien de redirection \n        // pour renvoyer vers la vue de l'institution propriétaire de la collection.\n        if (view_institution != collection_institution){\n\n            this.parentCtrl._breadcrumbStateParams.vid = collection_institution + '_VU1';\n            //On force le rechargemene de la page pour appliquer le changement de vue \n            this.$element.parent().children()[0].setAttribute(\"target\", \"_self\");\n        }\n        \n\n        //On ajoute le nom de l'institution propriétaire de la collection au niveau du lien de premier niveau  \n        if (typeof this.parentCtrl._breadcrumbStateParams.collectionId === \"undefined\" && typeof this.parentCtrl.$stateParams.collectionId === \"undefined\") {\n            let title;\n            this.$translate('nui.colldiscovery.lobby.linktitle.'+ this.parentCtrl.institution).then((translation) => {\n                title = translation\n                console.log(title);\n                this.$element.parent().children()[0].children[0].innerText = title;\n               \n            });\n           \n            // 33PUDB_UB.nui.colldiscovery.lobby.toptitle\n        }\n\n    }\n;\n}\nchangeLinkToCollectionDiscoveryController.$inject = ['$element', '$translate'];\nexport let changeLinkToCollectionDiscoveryConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: changeLinkToCollectionDiscoveryController\n}","\nimport logosInstsTemplate from './logosInsts.html'\n\nclass logosInstsController {\n    constructor(){\n\n      var url = new URL(document.location.href);\n      var lang = url.searchParams.get('lang');\n      var pathname = url.pathname;\n      var displayFooter = url.searchParams.get('displayFooter');\n      var view = url.searchParams.get('vid');\n      var openUrl = url.searchParams.get('url_ver');\n      var re = /_VU./g;\n      var myInstitution = view.replace(re,\"\"); \n      this.institutionsList = [];\n      this.institutionsUrl = {};\n      this.displayFooter = true;\n      if (displayFooter == 'false'){\n        this.displayFooter = false;\n      }\n      this.parentCtrl.mappingTablesCache.MAPPING_TABLES_CACHE['Alma Institution Codes'].forEach((institutionObjet)=>{\n        var institution = institutionObjet.source1;\n        console.log(institution);\n        if (institution != \"33PUDB_NETWORK\") {\n          var regex = new RegExp(myInstitution, \"g\");\n          this.institutionsList.push(institution);\n          this.institutionsUrl[institution] = 'https://'+ url.hostname + '/primo-explore/search?vid=' + institution + '_VU1';\n        \n        }\n       \n      });\n      \n      this.message = \"Réseau des bibliothèques universitaires bordelaises\";    \n      \n      this.institutionsList.sort();\n\n  }\n};\n// logosInstsController.$inject = ['$http','$element','$sce'];\nexport let logosInstsConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: logosInstsController,\n    template:logosInstsTemplate\n  }\n  ","\n/*[33PUDB_NETWORK_AFA] - Customisation de la toplevel facette  */\n/*Suprime les entrées 'peer_reviewed','open_access'et'available'*/\nclass tLevelFacetteController {\n  constructor(){\n    console.log('----> 33PUDB tLevelFacetteController');\n    /*Filtre sur la top level facette*/\n    if (this.parentCtrl.facetGroup.name == \"tlevel\"){\n        /*Récupère les valeurs de la tlevel facette*/\n        var tlevelFacetsValues = this.parentCtrl.facetGroup.values;\n        // console.log(tlevelFacetsValues);\n        /*Parcours du tableau des valeurs*/\n        for (var i = 0; i < tlevelFacetsValues.length; i++) {\n            /*Récupère le nom de la facette*/\n            var facetName = tlevelFacetsValues[i].value;\n            // console.log(facetName);\n            /*On supprime les entrées relatives à la tlevel*/\n            if (['peer_reviewed', 'open_access', 'available'].includes(facetName)) {\n                tlevelFacetsValues.splice(i, 1);\n                i = i - 1;\n                // console.log(\"Supprimée\");\n            }\n        }\n    }\n  }\n\n  get recordid() {\n    return this.parentCtrl.item.pnx.control.recordid[0];\n  }\n}\n\nexport let tLevelFacetteConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: tLevelFacetteController\n}\n","/*[33PUDB_NETWORK_AFA] - Affiche la disponibilité des RE dans une autre institution*/\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Marc7167182610004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20de%20droit&offset=0\n//http://localhost:8003/primo-explore/fulldisplay?docid=33PUDB_Alma_Unimarc7157521910004671&context=L&vid=33PUDB_UB_VU2&lang=en_US&search_scope=catalog_pci&adaptor=Local%20Search%20Engine&tab=default_tab&query=any,contains,revue%20fran%C3%A7aise%20de%20gestion\nimport dispoElecAutresInstHTML from './dispoElecAutresInst.html'\n\nclass dispoElecAutresInstController {\n  constructor($sce) {\n    console.log(this);\n    this.sce = $sce;\n    /* Parfois les services ne sont pas passés au controleur parent...*/\n    if (typeof this.parentCtrl.service !== 'undefined'){\n      this.serviceName = this.parentCtrl.service.scrollId;\n      /*On ne travaille qu'au niveau du view it*/\n      if (this.serviceName == \"getit_link1_0\" && this.parentCtrl.service.linkElement.category == \"Alma-E\") {\n        // console.log('---->dispoElecAutresInstController');\n        //Vue actuelle\n        this.REBUB_vue = this.parentCtrl.configurationUtil.vid;\n        //Je récupère le code de l'institution\n        this.REBUB_institution = this.parentCtrl.configurationUtil.vid.match(/(33PUDB_\\S+?)_/)[1];\n        this.institutionsLIst = [];\n        this.dispos = this.parentCtrl.item.pnx.delivery.delcategory;\n        this.isShowContent = {};\n        // console.log(this);\n        //Je construit une liste avec chaque institution proposant l'accès électronique au documment (pnx/delivery/delcategory)\n        for (var i = 0; i < this.dispos.length; i++) {\n          var dispoElement = this.dispos[i].match(/(\\$\\$V|^)(.*?)\\$\\$I(.*?)(\\$|$)/);\n          if (dispoElement[2] == \"Alma-E\" && dispoElement[3] != this.REBUB_institution && dispoElement[3] != \"33PUDB_NETWORK\") {\n            this.institutionsLIst.push(dispoElement[3]);\n            this.isShowContent[dispoElement[3]] = false;\n          }\n        }\n        this.dispo_autres_inst = this.institutionsLIst.length > 0 ? true : false;\n        // console.log(this.institutionsLIst);\n      }\n    }\n  }\n\n  showComponent(institution) {\n\n    /*Construction de l'Open Url*/\n    /************************** */\n    var instanceAlma = institution.match(/33PUDB_(.*)/)[1].toLowerCase();\n    var skin = institution + '_VU1';\n    var langue = this.parentCtrl.item.lang3 ? this.parentCtrl.item.lang3 : \"fre\";\n    var date = new Date();\n    var ctxTim = date.toISOString();\n    /*On récupère l'identifiant des notices Alma*/\n    var almaIdList = this.parentCtrl.item.pnx.control.almaid;\n    var isDedup = this.parentCtrl.item.pnx.control.recordid[0].startsWith('dedup');\n    var ids_notice = [];\n    for (var i = 0; i < almaIdList.length; i++) {\n      /*Si la notice est fusionnée, les idAlma sont affichés comme ça : $$V33PUDB_NETWORK:7167176110004671$$O33PUDB_Alma_Marc7167176110004671\n      On extrait l'identifiant et on filtre les notices électroniques (Alma_Marc)*/\n      if (isDedup){\n        var idElement = almaIdList[i].match(/\\$\\$V(.*?)\\$\\$O.*?_.*?_(.*?)\\d/);\n        if (idElement[2] == 'Marc'){\n          ids_notice.push('ie=' + idElement[1]);\n        }\n      }\n      else{\n        ids_notice.push('ie=' + almaIdList[i]);\n      }\n    }\n    this.openUrl = \"https://pudb-\" + instanceAlma\n                   + \".userservices.exlibrisgroup.com/view/uresolver/\"\n                   + institution \n                   + \"/openurl?ctx_enc=info:ofi/enc:UTF-8&ctx_id=10_1&ctx_tim=\" \n                   + ctxTim \n                   + \"&ctx_ver=Z39.88-2004&url_ctx_fmt=info:ofi/fmt:kev:mtx:ctx&url_ver=Z39.88-2004&rfr_id=info:sid/primo.exlibrisgroup.com-33PUDB_Alma_Marc&req_id=&rft_dat=\" \n                   + ids_notice.toString() \n                   + \",language=\" \n                   + langue\n                   + \",view=\" \n                   + this.REBUB_vue\n                   + \"&svc_dat=viewit&u.ignore_date_coverage=true&is_new_ui=true&Force_direct=false&req.skin=\" \n                   + skin;\n    /*Masquage/Affichage  de l'iframe*/\n    /******************************** */\n    for (var i in this.isShowContent) {\n      // console.log(i);\n      if(i != institution){\n        this.isShowContent[i] = false;  \n      }\n    }\n    this.isShowContent[institution] = !this.isShowContent[institution];\n    this.templateURL = 'custom/CENTRAL_PACKAGE/js/prmFullViewServiceContainerAfter/bouttonAfficheDispoElec.html';\n    // console.log(this.isShowContent);\n\n  }\n  trustAsUrl(url){\n    return this.sce.trustAsResourceUrl(url);\n  }\n}\n\ndispoElecAutresInstController.$inject = ['$sce'];\n\nexport let dispoElecAutresInstConfig = {\n  bindings: { parentCtrl: '<' },\n  controller: dispoElecAutresInstController,\n  template: dispoElecAutresInstHTML\n}","\nclass customGalleryDisplayController {\n    constructor($element){\n      setTimeout (()=>{\n        this.$element = $element;\n        // this.$document = $document;\n         console.log('---->33PUDB customGalleryDisplayController');\n         console.log(this);\n         var firstLine = this.parentCtrl.item.pnx.display.lds02 === undefined ? \"\" : this.parentCtrl.item.pnx.display.lds02;\n         var secondLine = this.parentCtrl.item.pnx.display.lds01 === undefined ? \"\" : this.parentCtrl.item.pnx.display.lds01;\n         console.log(this.$element[0].parentElement);\n         var conteneur = this.$element[0].parentElement.querySelector('div.item-info');\n         var infoExElement = document.createElement('div');\n         infoExElement.setAttribute('class','infoEx')\n         var firstLineElement = document.createElement('p');\n         firstLineElement.setAttribute('class','firstLine');\n         firstLineElement.innerText = firstLine;\n         infoExElement.appendChild(firstLineElement);\n         var secondLineElement = document.createElement('p');\n         secondLineElement.setAttribute('class','secondLine');\n         secondLineElement.innerText = secondLine;\n         infoExElement.appendChild(secondLineElement);\n         conteneur.appendChild(infoExElement);\n      }, 1000);\n    }\n  }\n\n  customGalleryDisplayController.$inject = ['$element'];\n  \n  export let customGalleryDisplayConfig = {\n    bindings: {parentCtrl:'<'},\n    controller: customGalleryDisplayController,\n  }","class itemInLoanController {\n    constructor($element, $translate) {\n        this.$translate = $translate;\n        console.log(\"--->itemInLoanController\");\n        console.log(this);\n        var loanDate = this.parentCtrl.item.loandate;\n        var dueDate = this.parentCtrl.item.duedate;\n        var today = new Date();\n        var loanDuration = calcDiffDate(formatDate(dueDate), formatDate(loanDate));\n        var daysSinceLoanDate = calcDiffDate(today, formatDate(loanDate));\n        var institution = this.parentCtrl.item.ilsinstitutioncode;\n        console.log(institution);\n        if (institution != '33PUDB_UB'){\n            this.$translate('nui.loans.' + institution + '_duree_prolongation').then((duree_prolongation) => {\n                console.log(\"Durée de prolongation : \" + duree_prolongation);\n                // Si la durée du prêt est supérieure à la durée de la prolongation et si le nombre de jour écoulé depuis la date d'emprunt est inférieure à la durée de la prolongation\n                // Alors on bloque le prêt jusqu'à ce que le nombre de jours d'emprunt écoulés soit égal au nombre de jours de prolongation\n                // duree_prolongation = 14\n                if (loanDuration > duree_prolongation && this.parentCtrl.item.renew === \"Y\" && daysSinceLoanDate < duree_prolongation) {\n                    this.parentCtrl.item.renew = \"N\";\n                    $element.parent().children()[0].children[4].innerHTML = newButtonMsg(addDays(formatDate(loanDate), duree_prolongation), this.parentCtrl.loansService.requestParams.lang);\n                }\n                // Si la durée du prêt est inférieure à la durée de la prolongation alors on permet la prolongation 2 jours avant la date d'échéance du prêt.\n                else if (loanDuration <= duree_prolongation && this.parentCtrl.item.renew === \"Y\") {\n                    this.parentCtrl.item.renew = \"N\";\n                    $element.parent().children()[0].children[4].innerHTML = newButtonMsg(addDays(formatDate(dueDate), -2), this.parentCtrl.loansService.requestParams.lang);\n                }\n\n            });\n            console.log(\"Exemplaire emprunté le \" + loanDate + \". A rendre le \" + dueDate + \".\");\n            console.log(\"Exemplaire emprunté le \" + formatDate(loanDate) + \". A rendre le \" + formatDate(dueDate) + \".\");\n            console.log(\"Durée du prêt :\" + loanDuration);\n            // Si la durée du prêt est supérieure à 7 jours\n        }\n\n        // On vide l'affichage détaillé et on ne conserve que la dated'emprunt \n        this.parentCtrl.item._fullDisplayValues = [{ key: \"loan_date\", value: this.parentCtrl.item.loandate },\n        { key: \"max_renew_date\", value: this.parentCtrl.item.maxrenewdate }];\n\n\n\n\n        function formatDate(date) {\n            var regex = /(\\d{2})\\/(\\d{2})\\/(\\d{4})/;\n            var [, day, month, year] = regex.exec(date)\n            var formatedDate = new Date(year, month -1, day);\n            console.log(formatedDate);\n            return formatedDate;\n        }\n        function calcDiffDate(firstDate, secondDate) {\n            var oneDay = 24 * 60 * 60 * 1000; // hours*minutes*seconds*milliseconds    \n            var diffDays = Math.round(Math.abs((firstDate.getTime() - secondDate.getTime()) / (oneDay)));\n            // console.log(diffDays);\n            return diffDays\n        }\n        function addDays(date, days) {\n            var result = new Date(date.getFullYear(),\n                date.getMonth(),\n                date.getDate() + days,\n                date.getHours(),\n                date.getMinutes(),\n                date.getSeconds(),\n                date.getMilliseconds()\n            );\n            // console.log(\"Result : \" + result.toLocaleDateString());\n            return result.toLocaleDateString();\n        }\n        function newButtonMsg(renewdateok, lang = 'fr_FR') {\n            var msg = {\n                \"fr_FR\": \"Prolongation impossible avant le \",\n                \"en_US\": \"Not renewable before \",\n                \"es_ES\": \"No renovable hasta \"\n            };\n            var fullMsg = msg[lang] + renewdateok;\n            var html = '<div class=\"not-renewable weak-text layout-align-start-center\" aria-label=\"' + fullMsg;\n            html = html + ' aria-hidden=\"false\" layout-align=\"start center\"><prm-icon icon-type=\"svg\" svg-icon-set=\"primo-ui\" icon-definition=\"lock\"><!----><md-icon ng-if=\"!$ctrl.isCustom\" md-svg-icon=\"primo-ui:lock\" alt=\"\" class=\"md-primoExplore-theme\" aria-hidden=\"true\"><svg id=\"lock\" width=\"100%\" height=\"100%\" viewBox=\"0 0 24 24\" y=\"1320\" xmlns=\"http://www.w3.org/2000/svg\" fit=\"\" preserveAspectRatio=\"xMidYMid meet\" focusable=\"false\"><path d=\"M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z\"></path>   </svg></md-icon><!----><!----><prm-icon-after parent-ctrl=\"$ctrl\"></prm-icon-after></prm-icon><span>';\n            html = html + fullMsg + '</span><!----></div><!---->';\n            return html;\n        }\n    }\n\n}\nitemInLoanController.$inject = ['$element', '$translate'];\nexport let itemInLoanConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: itemInLoanController\n}","import authentificationForm from './authentificationAutresInst.html'\n\nclass authentificationAutresInstController {\n    constructor() {\n        //Debug\n        // console.log('---->33PUDB authentificationAutresInstController');\n        //DEBUG\n        // console.log(this);\n        //On recupere le host\n        this.hostAuth = this.parentCtrl.$location.$$host;\n        // console.log(\"hostAuth:\" + this.hostAuth);\n        //On récupère l'URL de départ :\n        //[AFA Patch 20/02/2019 : https://trello.com/c/Vsm7VgdA ] On teste le chemin car quand on arrive de l'extérieur et que la page ciblée demande une authentification fournie $$absurl est l'url de l'écran de login. Pour l'instant les seuls liens externes de cetypes pointent vers le compte lecteur. Donc si $$absUrl pointe vers l'écran de login on redirge vers  \n        if (this.parentCtrl.$location.$$path == \"/login\") {\n            this.absUrl = 'https://' + this.hostAuth + '/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n            //URL pour le travail en localhost\n            // this.absUrl = 'https://babordplus.hosted.exlibrisgroup.com/primo-explore/account?vid=33PUDB_UBM_VU1&section=overview';\n        }\n        else {\n            this.absUrl = this.parentCtrl.$location.$$absUrl;\n        }\n        //On encode correctement l'URL targeturl \n        this.absUrl = encodeURIComponent(this.absUrl);\n        // console.log(\"absUrl:\" + this.absUrl);\n        //On recupere le code vue source\n        this.sourceView = this.parentCtrl.$location.$$search.vid;\n        // console.log(\"sourceView:\" + this.sourceView);\n        //On récupére la langue de la session\n        this.langue = this.parentCtrl.$stateParams.lang;\n        //On contruit le debut de l'url pour l authentification\n        this.auth_base_url_const = 'https://' + this.hostAuth + '/primo_library/libweb/primoExploreLogin?institution=';\n        //URL Pour tester en local\n        // this.auth_base_url_const = 'https://babordplus.hosted.exlibrisgroup.com/primo_library/libweb/primoExploreLogin?institution=' ;\n        //Parcours d'une liste asso pour afficher auth IdP supplementaires\n        this.PUDB_Auth_Lists =  [\n                                    [\"1\", \"33PUDB_BXSA\", \"33PUDB_BXSA_SAML_BXSA\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_BXSA_VU1\"), \"33PUDB_BXSA_VU1\", \"Bordeaux Sciences Agro\"], \n                                    [\"2\", \"33PUDB_IEP\", \"33PUDB_IEP_SAML_IEP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_IEP_VU1\"), \"33PUDB_IEP_VU1\", \"Bordeaux Sciences Po\"],\n                                    [\"3\", \"33PUDB_UB\", \"33PUDB_UB_SAML_UB\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UB_VU1\"), \"33PUDB_UB_VU1\", \"Université de Bordeaux\"],\n                                    [\"4\", \"33PUDB_UBM\", \"33PUDB_UBM_SAML_UBM\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_UBM_VU1\"), \"33PUDB_UBM_VU1\", \"Université Bordeaux Montaigne\"], \n                                    [\"5\", \"33PUDB_INP\", \"33PUDB_INP_SAML_INP\", this.absUrl.replace(/vid\\%3D33PUDB_.*_VU1/, \"vid%3D33PUDB_INP_VU1\"), \"33PUDB_INP_VU1\", \"Bordeaux INP\"]];\n    }\n\n    setIdPShow(institution) {\n        //Le lien n'est pas proposé pour l'inst\n        // console.log(institution);\n        return Boolean(this.parentCtrl.usernamePasswordLoginService.inst !== institution);\n\n    }\n}\n\nexport let authentificationAutresInstConfig = {\n    bindings: { parentCtrl: '<' },\n    controller: authentificationAutresInstController,\n    template: authentificationForm\n}","\nimport affDispo from './affDispo.html'\n//http://localhost:8003/primo-explore/search?query=any,contains,33PUDB_Alma_Unimarc7156806840004671%20OR%2033PUDB_Alma_Unimarc7180719980004671&tab=default_tab&search_scope=catalog_pci&vid=33PUDB_UBM_VU1&lang=en_US&offset=0\n//Cf. case Exlib # 00641786\n//Remonte la deuxième mention de disponibilté qui est parfois non affichée quand notices imprimés et électroniques ont été fusionnées \nclass affDispoController {\n  constructor($scope, $http, $element, $templateCache){\n    console.log('---->affDispoController');\n    if (this.parentCtrl.result.pnx.control.recordid[0].startsWith('dedup')){\n      // console.log(this.parentCtrl.result.pnx.display.title);\n      // console.log(this.parentCtrl.result.delivery);\n      if (this.parentCtrl.result.delivery.deliveryCategory.length == 1){\n        if (typeof this.parentCtrl.result.delivery.GetIt2 !== 'undefined') {\n          console.log('---->affDispoController : recalcule de la disponibilité');\n          var availability = getAvailabilityStatus(this.parentCtrl.result.delivery.holding);\n          this.locations = [];\n          this.locations.push({\n            availability: availability,\n            deliveryCode: 'delivery.code.'+ availability,\n            // toTranslate: productionVID(window.appConfig.vid),\n            useLinkIcon: true,\n            // outboundLink: illLink(pnx),\n          })\n      }\n      console.log(this.locations);\n      }\n    }\n    function getAvailabilityStatus(holding){\n      console.log(holding);\n      if (typeof holding == 'undefined' || holding == null) {\n        return \"unavailable_in_all_institutions\";\n      }\n      var availabilityStatus = [];\n      for (var i = 0; i < holding.length; i++) {\n        if (holding[i].isValidUser){\n          availabilityStatus.push(holding[i].availabilityStatus);  \n        }\n      }\n      if (availabilityStatus.length == 0){\n          return \"does_not_exist_in_maininstitution\";\n      }\n      else{\n        if (availabilityStatus.includes('available')){\n          return \"available_in_maininstitution\";\n        }\n        else {\n          return \"check_holdings\";\n        }\n      }\n    }\n    console.log(this);\n  }\n}\naffDispoController.$inject = ['$scope', '$http', '$element', '$templateCache' ]\nexport let affDispoConfig = {\n  bindings: {parentCtrl:'<'},\n  controller: affDispoController,\n  template: affDispo\n}\n","var showForInst = ['33PUDB_UB','33PUDB_BXSA']\n\nclass panierController {\n\n  constructor($http,$element) {\n      this.$http = $http;\n      this.element = $element;  \n \n     \n      console.log(\"Panier\");\n      console.log(this);\n      let view = this.parentCtrl.view;\n      this.institution = view.replace(/^(33PUDB_.*?)_.*/, '$1');\n      this.showLink = showForInst.includes(this.institution) ? true : false; \n      this.uSMS = this.parentCtrl.userSessionManagerService;\n      this.panierUser = \"\";\n      console.log(this);\n    \n      if (this.uSMS) {\n        let jwtData = this.uSMS.jwtUtilService.getDecodedToken() || {};\n        console.log(jwtData);\n        this.panierUser = jwtData.user;\n\n      }\n      this.panierUrl = \"https://scoop.u-bordeaux.fr/panier/\" +  this.panierUser +\"/\" + this.institution;\n    }\n  };\n\n\n  panierController.$inject = ['$http','$element'];\n  export let panierConfig = {\n      bindings: {parentCtrl:'<'},\n      controller: panierController,\n      template: `\n        <div ng-if=\"$ctrl.uSMS.isGuest() == false && $ctrl.showLink == true\" id=\"panier-covid\" class=\"layout-align-center layout-row\">\n          <a class=\"md-icon-button button-over-dark md-button md-primoExplore-theme md-ink-ripple\"\n                    aria-label=\"Votre Panier\" ng-click=\"$ctrl.openHelpMenu($event)\"\n                    href=\"{{$ctrl.panierUrl}}\" target=\"_blank\" title=\"Accèder à vos documents réservés pour finaliser la commande\">\n            <prm-icon icon-type=\"svg\" svg-icon-set=\"action\" icon-definition=\"ic_shopping_basket_24px\"></prm-icon>\n          </a>\n        </div>`,\n    }\n    \nclass panierCompteLecteurController {\n    constructor($http,$element) {\n      console.log(\"Lien Panier\");\n      console.log(this);\n      this.$http = $http;\n      this.element = $element;\n      this.cetcinst=showForInst;\n      console.log(this.requestsCounter)\n      let jwtData = this.parentCtrl.jwtUtilService.getDecodedToken() || {};\n      console.log(jwtData);\n      this.panierUser = jwtData.user;\n      // this.institution = jwtData.institution.replace(/^33PUDB_(.*?)$/, '$1');\n      // this.showLink = (showForInst.includes(this.institution) && this.request_count > 0) ? true : false; \n      // // console.log(this.parentCtrl.accountOverviewService);\n      // this.panierUrl = \"https://scoop.u-bordeaux.fr/panier/\" +  this.panierUser +\"/\" + this.institution;\n\n    }\n  };\n\n\n  panierCompteLecteurController.$inject = ['$http','$element'];\n  export let panierCompteLecteurConfig = {\n      bindings: {parentCtrl:'<'},\n      controller: panierCompteLecteurController,\n      template: `\n       <a ng-if=\"$ctrl.parentCtrl.requestsCounter > 0 && $ctrl.cetcinst.indexOf($ctrl.parentCtrl.accountOverviewService.linkedUserSelectorService._selectedInstitution.institutionCode) > -1\"\n          class=\"button-link md-button button-large md-primoExplore-theme md-ink-ripple\"\n          type=\"button\"\n          href=\"https://scoop.u-bordeaux.fr/panier/{{ $ctrl.panierUser }}/{{ $ctrl.parentCtrl.accountOverviewService.linkedUserSelectorService._selectedInstitution.institutionCode }}\"\n          target=\"_blank\" title=\"Accèder à vos documents réservés pour finaliser la commande\" style=\"\">\n         <prm-icon icon-type=\"svg\" svg-icon-set=\"action\" icon-definition=\"ic_shopping_basket_24px\"></prm-icon>\n         <span>Prendre rendez-vous pour le retrait des documents</span>\n       </a>`,\n    }\n\n    // "],"sourceRoot":"/source/"}